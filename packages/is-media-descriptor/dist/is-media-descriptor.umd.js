/**
 * is-media-descriptor
 * Is given string a valid media descriptor (including media query)?
 * Version: 3.0.1
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/is-media-descriptor/
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).isMediaDescriptor={})}(this,(function(e){"use strict";function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?o(Object(i),!0).forEach((function(o){t(e,o,i[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var i=[],s=[],f=function(e,t){if(e===t)return 0;var o=e;e.length>t.length&&(e=t,t=o);for(var r=e.length,f=t.length;r>0&&e.charCodeAt(~-r)===t.charCodeAt(~-f);)r--,f--;for(var n,a,l,c,u=0;u<r&&e.charCodeAt(u)===t.charCodeAt(u);)u++;if(f-=u,0===(r-=u))return f;for(var m=0,d=0;m<r;)s[m]=e.charCodeAt(u+m),i[m]=++m;for(;d<f;)for(n=t.charCodeAt(u+d),l=d++,a=d,m=0;m<r;m++)c=n===s[m]?l:l+1,a=i[m]=(l=i[m])>a?c>a?a+1:c:c>l?l+1:c;return a},n=f;n.default=f;var a=["all","aural","braille","embossed","handheld","print","projection","screen","speech","tty","tv"],l=["width","min-width","max-width","height","min-height","max-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","orientation","resolution","min-resolution","max-resolution","scan","grid","update","overflow-block","overflow-inline","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","color-gamut","pointer","hover","any-pointer","any-hover"],c=/^\w+$/g;var u={offset:0};e.defaults=u,e.isMediaD=function(e,t){var o=r(r({},u),t);if(o.offset&&!Number.isInteger(o.offset))throw new Error("is-media-descriptor: [THROW_ID_01] opts.offset must be an integer, it was given as "+o.offset+" (type "+typeof o.offset+")");if(o.offset||(o.offset=0),"string"!=typeof e)return[];if(!e.trim())return[];var i=[],s=0,f=e.length,m=e.trim();if(e!==e.trim()){var d=[];if(!e[0].trim())for(var p=0,h=e.length;p<h;p++)if(e[p].trim()){d.push([0+o.offset,p+o.offset]),s=p;break}if(!e[e.length-1].trim())for(var g=e.length;g--;)if(e[g].trim()){d.push([g+1+o.offset,e.length+o.offset]),f=g+1;break}i.push({idxFrom:d[0][0],idxTo:d[d.length-1][1],message:"Remove whitespace.",fix:{ranges:d}})}if(a.includes(m))return i;if(["only","not"].includes(m))i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:"Missing media type or condition.",fix:null});else if(!m.match(c)||m.includes("(")||m.includes(")")){var x=!1,b=Array.from(m).reduce((function(e,t,r){return")"===t?(!x&&e[1]+1>e[0]&&(x=!0),[e[0],e[1]+1]):"("===t?[e[0]+1,e[1]]:(";"===t&&i.push({idxFrom:r+o.offset,idxTo:r+1+o.offset,message:"Semicolon found!",fix:null}),e)}),[0,0]),v=b[0],y=b[1];if(x&&v===y&&i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:"Some closing brackets are before their opening counterparts.",fix:null}),v>y?i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:"More opening brackets than closing.",fix:null}):y>v&&i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:"More closing brackets than opening.",fix:null}),!i.length&&m.match(/\(\s*\)/g))for(var w,O=null,C=0,T=m.length;C<T;C++)"("===m[C]?(O=C,w=!1):")"===m[C]&&O?w?w=!0:i.push({idxFrom:O+o.offset,idxTo:C+1+o.offset,message:"Empty bracket pair.",fix:null}):m[C].trim()&&(w=!0);if(i.length)return i;!function(e,t){if("string"!=typeof e)throw new Error("string-process-comma-separated: [THROW_ID_01] input must be string! It was given as "+typeof e+", equal to:\n"+JSON.stringify(e,null,4));if(e.length&&t&&(t.cb||t.errCb)){var o=r(r({},{from:0,to:e.length,offset:0,leadingWhitespaceOK:!1,trailingWhitespaceOK:!1,oneSpaceAfterCommaOK:!1,innerWhitespaceAllowed:!1,separator:",",cb:null,errCb:null}),t);Number.isInteger(t.from)||(o.from=0),Number.isInteger(t.to)||(o.to=e.length),Number.isInteger(t.offset)||(o.offset=0);for(var i=null,s=null,f=!1,n=[],a=null,l=!0,c=o.from;c<o.to;c++){if(e[c].trim()&&e[c]!==o.separator&&(a=c),null!==i||!e[c].trim()||o.separator&&e[c]===o.separator||(f||(f=!0),n.length&&(n.length>1&&n.forEach((function(e,t){t&&o.errCb([[e+o.offset,e+1+o.offset]],"Remove separator.",l)})),n=[]),i=c),Number.isInteger(i)&&(c>i&&o.separator&&e[c]===o.separator||c+1===o.to)&&(e.slice(i,c+1===o.to&&e[c]!==o.separator&&e[c].trim()?c+1:c),"function"==typeof o.cb&&o.cb(i+o.offset,(c+1===o.to&&e[c]!==o.separator&&e[c].trim()?c+1:a+1)+o.offset),i=null),e[c].trim()||null!==s||(s=c),null!==s&&(e[c].trim()||c+1===o.to)){if(s===o.from)o.leadingWhitespaceOK||"function"!=typeof o.errCb||o.errCb([[s+o.offset,(c+1===o.to?c+1:c)+o.offset]],"Remove whitespace.",l);else if(e[c].trim()||c+1!==o.to){if(!(o.oneSpaceAfterCommaOK&&e[c].trim()&&c>o.from+1&&" "===e[c-1]&&","===e[c-2]||o.innerWhitespaceAllowed&&f&&e[s-1]&&e[c].trim()&&e[c]!==o.separator&&e[s-1]!==o.separator)){var u=s,m=c;c+1!==o.to||e[c]===o.separator||e[c].trim()||(m+=1);var d="";o.oneSpaceAfterCommaOK&&(" "===e[s]&&e[s-1]===o.separator?u+=1:" "!==e[s]&&(d=" "));var p="Remove whitespace.";!o.innerWhitespaceAllowed&&f&&e[s-1]&&e[c].trim()&&e[c]!==o.separator&&e[s-1]!==o.separator&&(l=!1,p="Bad whitespace."),o.errCb(d.length?[[u+o.offset,m+o.offset,d]]:[[u+o.offset,m+o.offset]],p,l),l=!0}}else o.trailingWhitespaceOK||"function"!=typeof o.errCb||o.errCb([[s+o.offset,c+1+o.offset]],"Remove whitespace.",l);s=null}e[c]===o.separator&&(f?n.push(c):o.errCb([[c+o.offset,c+1+o.offset]],"Remove separator.",l)),c+1===o.to&&n.forEach((function(e){o.errCb([[e+o.offset,e+1+o.offset]],"Remove separator.",l)}))}}}(m,{offset:o.offset,leadingWhitespaceOK:!1,trailingWhitespaceOK:!1,oneSpaceAfterCommaOK:!0,innerWhitespaceAllowed:!0,separator:",",cb:function(e,t){!function(e,t,o){for(var r=null,i=[],s=null,f=!0,n=!0,u=!0,m=!1,d=[],p=t.idxFrom;p<=t.idxTo;p++){if(")"===e[p]){var h=d.pop(),g=e.slice(h+1,p);g.includes("(")||g.includes(")")||g.match(c)&&(l.includes(g.toLowerCase().trim())||o.push({idxFrom:h+1+t.offset,idxTo:p+t.offset,message:'Unrecognised "'+g.trim()+'".',fix:null}));var x=new RegExp(a.join("|"),"gi");(g.match(x)||[]).forEach((function(r){var i=e.indexOf(r);o.push({idxFrom:i+t.offset,idxTo:i+r.length+t.offset,message:'Media type "'+r+'" inside brackets.',fix:null})}))}if("("===e[p]&&d.push(p),e[p]&&e[p].trim().length&&null!==s){if("("===e[s-1]||")"===e[p])o.push({idxFrom:s+t.offset,idxTo:p+t.offset,message:"Bad whitespace.",fix:{ranges:[[s+t.offset,p+t.offset]]}});else if(s<p-1||" "!==e[p-1]){var b=s+t.offset,v=p+t.offset,y=" ";s!==p-1&&(" "===e[s]?(b+=1,y=null):" "===e[p-1]&&(v-=1,y=null)),o.push({idxFrom:s+t.offset,idxTo:p+t.offset,message:"Bad whitespace.",fix:{ranges:[y?[b,v," "]:[b,v]]}})}s=null}if(e[p]&&!e[p].trim().length&&null===s&&(s=p),!(null===r||e[p]&&e[p].trim().length||d.length)){var w=e.slice(r,p);if(i.push(w.toLowerCase()),!m||(f||n)&&"and"!==w)if(u&&["not","only"].includes(w))u=!1,n=!1;else if(f||n){if(w.startsWith("("))if(n);else{var O='Media condition "'+e.slice(r,p)+"\" can't be here.";"not"===i[i.length-2]&&(O='"not" can be only in front of media type.'),o.push({idxFrom:r+t.offset,idxTo:p+t.offset,message:O,fix:null})}else{if(!f){var C='Expected brackets on "'+w+'".',T=null,F=p+t.offset;if(["not","else","or"].includes(w.toLowerCase()))C='"'+w+"\" can't be here.";else if(a.includes(w.toLowerCase()))C="Unexpected media type, try using a comma.";else if(l.includes(w.toLowerCase()))C="Missing brackets.",T={ranges:[[r+t.offset,r+t.offset,"("],[p+t.offset,p+t.offset,")"]]};else if(e.slice(p).trim().startsWith(":")){var j=w.slice(0,p).trim();C='Expected brackets on "'+j+'" and its value.',F=r+j.length+t.offset}o.push({idxFrom:r+t.offset,idxTo:F,message:C,fix:T});break}if(a.includes(w.toLowerCase()))f=!1,n=!1;else{var A='Unrecognised "'+w+'".';w.match(/\w/g)?["and","only","or","not"].includes(w.toLowerCase())&&(A='"'+w+'" instead of a media type.'):A="Strange symbol"+(1===w.trim().length?"":"s")+' "'+w+'".',o.push({idxFrom:r+t.offset,idxTo:p+t.offset,message:A,fix:null})}}m=!0}else o.push({idxFrom:r+t.offset,idxTo:p+t.offset,message:'Unrecognised media type "'+e.slice(r,p)+'".',fix:null});else"and"!==w.toLowerCase()?o.push({idxFrom:r+t.offset,idxTo:p+t.offset,message:'Expected "and", found "'+w+'".',fix:null}):e[p]||o.push({idxFrom:r+t.offset,idxTo:p+t.offset,message:'Dangling "'+w+'".',fix:{ranges:[[e.slice(0,r).trim().length+t.offset,p+t.offset]]}}),m=!1,n=!0;r=null,u&&(u=!1)}null===r&&e[p]&&e[p].trim().length&&")"!==e[p]&&(r=p)}}(m,r(r({},o),{},{idxFrom:e-o.offset,idxTo:t-o.offset}),i)},errCb:function(e,t){}})}else for(var F=0,j=a.length;F<j;F++){if(1===n(a[F],m)){i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:'Did you mean "'+a[F]+'"?',fix:{ranges:[[s+o.offset,f+o.offset,a[F]]]}});break}F===j-1&&i.push({idxFrom:s+o.offset,idxTo:f+o.offset,message:'Unrecognised media type "'+m+'".',fix:null})}return i},e.version="3.0.1",Object.defineProperty(e,"__esModule",{value:!0})}));
