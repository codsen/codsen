/**
 * emlint
 * Pluggable email template code linter
 * Version: 4.1.2
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/emlint/
 */

import{TypedEmitter as t}from"tiny-typed-emitter";import{fixEnt as a}from"string-fix-broken-named-entities";import{traverse as e}from"ast-monkey-traverse";import{getLineStartIndexes as r,lineCol as i}from"line-column-mini";import s from"lodash.clonedeep";import{cparser as n}from"codsen-parser";import o from"matcher";import l from"define-lazy-prop";import{processCommaSep as d}from"string-process-comma-separated";import{right as c,left as u,leftStopAtNewLines as b}from"string-left-right";import m from"lodash.isregexp";import{rMerge as h}from"ranges-merge";import{allHtmlAttribs as f}from"html-all-known-attributes";import g from"leven";import p from"mime-db";import{isRel as x}from"is-relative-uri";import v from"url-regex";import{isLangCode as A}from"is-language-code";import{isMediaD as N}from"is-media-descriptor";import{notEmailFriendly as T}from"html-entities-not-email-friendly";import E from"he";import{findMalformed as S}from"string-find-malformed";import{matchRight as I}from"string-match-left-right";import{pathPrev as V}from"ast-monkey-util";import y from"object-path";var F=["bad-character-acknowledge","bad-character-activate-arabic-form-shaping","bad-character-activate-symmetric-swapping","bad-character-application-program-command","bad-character-backspace","bad-character-bell","bad-character-break-permitted-here","bad-character-cancel","bad-character-cancel-character","bad-character-character-tabulation-set","bad-character-character-tabulation-with-justification","bad-character-control-0080","bad-character-control-0081","bad-character-control-0084","bad-character-control-0099","bad-character-control-sequence-introducer","bad-character-data-link-escape","bad-character-delete","bad-character-device-control-four","bad-character-device-control-one","bad-character-device-control-string","bad-character-device-control-three","bad-character-device-control-two","bad-character-em-quad","bad-character-em-space","bad-character-en-quad","bad-character-en-space","bad-character-end-of-medium","bad-character-end-of-protected-area","bad-character-end-of-selected-area","bad-character-end-of-text","bad-character-end-of-transmission","bad-character-end-of-transmission-block","bad-character-enquiry","bad-character-escape","bad-character-figure-space","bad-character-first-strong-isolate","bad-character-form-feed","bad-character-four-per-em-space","bad-character-function-application","bad-character-hair-space","bad-character-ideographic-space","bad-character-information-separator-four","bad-character-information-separator-one","bad-character-information-separator-three","bad-character-information-separator-two","bad-character-inhibit-arabic-form-shaping","bad-character-inhibit-symmetric-swapping","bad-character-interlinear-annotation-anchor","bad-character-interlinear-annotation-separator","bad-character-interlinear-annotation-terminator","bad-character-invisible-plus","bad-character-invisible-separator","bad-character-invisible-times","bad-character-left-to-right-embedding","bad-character-left-to-right-isolate","bad-character-left-to-right-mark","bad-character-left-to-right-override","bad-character-line-separator","bad-character-line-tabulation","bad-character-line-tabulation-set","bad-character-medium-mathematical-space","bad-character-message-waiting","bad-character-narrow-no-break-space","bad-character-national-digit-shapes","bad-character-negative-acknowledge","bad-character-next-line","bad-character-no-break-here","bad-character-nominal-digit-shapes","bad-character-non-breaking-space","bad-character-null","bad-character-ogham-space-mark","bad-character-operating-system-command","bad-character-paragraph-separator","bad-character-partial-line-backward","bad-character-partial-line-forward","bad-character-pop-directional-formatting","bad-character-pop-directional-isolate","bad-character-private-message","bad-character-private-use-1","bad-character-private-use-2","bad-character-punctuation-space","bad-character-replacement-character","bad-character-reverse-line-feed","bad-character-right-to-left-embedding","bad-character-right-to-left-isolate","bad-character-right-to-left-mark","bad-character-right-to-left-override","bad-character-set-transmit-state","bad-character-shift-in","bad-character-shift-out","bad-character-single-character-introducer","bad-character-single-shift-three","bad-character-single-shift-two","bad-character-six-per-em-space","bad-character-soft-hyphen","bad-character-start-of-heading","bad-character-start-of-protected-area","bad-character-start-of-selected-area","bad-character-start-of-string","bad-character-start-of-text","bad-character-string-terminator","bad-character-substitute","bad-character-synchronous-idle","bad-character-tabulation","bad-character-thin-space","bad-character-three-per-em-space","bad-character-word-joiner","bad-character-zero-width-joiner","bad-character-zero-width-no-break-space","bad-character-zero-width-non-joiner","bad-character-zero-width-space"],w=["tag-bad-self-closing","tag-bold","tag-closing-backslash","tag-is-present","tag-missing-closing","tag-missing-opening","tag-name-case","tag-rogue","tag-space-after-opening-bracket","tag-space-before-closing-bracket","tag-space-before-closing-slash","tag-space-between-slash-and-bracket","tag-void-frontal-slash","tag-void-slash"],C=["attribute-duplicate","attribute-malformed","attribute-on-closing-tag"],R=["css-rule-malformed","css-trailing-semi"],O=["bad-malformed-numeric-character-entity","bad-named-html-entity-malformed-nbsp","bad-named-html-entity-multiple-encoding","bad-named-html-entity-not-email-friendly","bad-named-html-entity-unrecognised"];function $(t,a,e,r){const i={...{offset:0,from:0,to:t.length},...r};let s=null,n=null;for(let r=i.from;r<i.to;r++)null!==n||t[r].trim().length||(n=r),null===n||!t[r].trim().length&&r+1!==i.to||("function"==typeof e&&e([n+i.offset,(t[r].trim().length?r:r+1)+i.offset]),n=null),null===s&&t[r].trim().length&&(s=r),null===s||t[r].trim().length&&r+1!==i.to||("function"==typeof a&&a([s+i.offset,(r+1===i.to&&t[r].trim().length?r+1:r)+i.offset]),s=null)}function k(t,a){if("string"!=typeof t)return{charStart:0,charEnd:0,errorArr:[],trimmedVal:""};let e,r=0,i=t.length;const n=[],o=[];return t.length&&t[0].trim().length||(r=c(t),t.length&&null!==r?n.push([a,a+r]):(i=null,o.push({idxFrom:+a,idxTo:+a+t.length,message:"Missing value.",fix:null}))),i&&!t[t.length-1].trim()&&(i=u(t,t.length-1)+1,n.push([a+i,a+t.length])),n.length?(o.push({idxFrom:n[0][0],idxTo:n[n.length-1][1],message:"Remove whitespace.",fix:{ranges:s(n)}}),n.length=0,e=t.trim()):e=t,{charStart:r,charEnd:i,errorArr:o,trimmedVal:e}}const B={caseInsensitive:!1};function L(t,a,e){const r={...B,...e};return!(!Array.isArray(t)||!t.length)&&t.some((t=>m(t)&&a.match(t)||"string"==typeof t&&(!r.caseInsensitive&&a===t||r.caseInsensitive&&a.toLowerCase()===t.toLowerCase())))}const M={caseInsensitive:!1,canBeCommaSeparated:!1,quickPermittedValues:[],permittedValues:[],noSpaceAfterComma:!1};function j(t,a,e,r,i,s){const n=t.slice(r,i);if(!L(e.quickPermittedValues,n,{caseInsensitive:e.caseInsensitive})&&!L(e.permittedValues,n,{caseInsensitive:e.caseInsensitive})){let o=null,l=`Unrecognised value: "${t.slice(r,i)}".`;L(e.quickPermittedValues,n.toLowerCase())||L(e.permittedValues,n.toLowerCase())?(l="Should be lowercase.",o={ranges:[[r+a,i+a,n.toLowerCase()]]}):Array.isArray(e.quickPermittedValues)&&e.quickPermittedValues.length&&e.quickPermittedValues.length<6&&e.quickPermittedValues.every((t=>"string"==typeof t))&&(!Array.isArray(e.permittedValues)||!e.permittedValues.length)&&e.quickPermittedValues.join("|").length<40?l=`Should be "${e.quickPermittedValues.join("|")}".`:Array.isArray(e.permittedValues)&&e.permittedValues.length&&e.permittedValues.length<6&&e.permittedValues.every((t=>"string"==typeof t))&&(!Array.isArray(e.quickPermittedValues)||!e.quickPermittedValues.length)&&e.permittedValues.join("|").length<40&&(l=`Should be "${e.permittedValues.join("|")}".`),s.push({idxFrom:r+a,idxTo:i+a,message:l,fix:o})}}function K(t,a,e){const r={...M,...e},{charStart:i,charEnd:s,errorArr:n}=k(t,a);return"number"==typeof i&&"number"==typeof s&&(r.canBeCommaSeparated?d(t,{offset:a,oneSpaceAfterCommaOK:!1,leadingWhitespaceOK:!0,trailingWhitespaceOK:!0,cb:(e,i)=>{t.slice(e-a,i-a),j(t,a,r,e-a,i-a,n)},errCb:(t,a)=>{n.push({idxFrom:t[0][0],idxTo:t[t.length-1][1],message:a,fix:{ranges:t}})}}):(t.slice(i,s),j(t,a,r,i,s,n))),n}const U=/^\.\w+$/g,P=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/g,_=/^[+-]?[1-7]$/,G=["apple-touch-icon","apple-touch-startup-image","alternate","archives","appendix","author","bookmark","canonical","chapter","contents","copyright","dns-prefetch","external","first","glossary","help","icon","import","index","last","license","manifest","modulepreload","next","nofollow","noopener","noreferrer","opener","pingback","preconnect","prefetch","preload","prerender","prev","search","shortlink","section","sidebar","start","stylesheet","subsection","tag","up"],q={"tag-missing-opening":"Opening tag is missing.","tag-missing-closing":"Closing tag is missing.","tag-void-frontal-slash":"Remove frontal slash."};function D(t){return"string"==typeof t&&1===t.length&&t.toUpperCase()!==t.toLowerCase()}function W(t){return Number.isInteger(t)&&t>0?t:Array.isArray(t)&&t.length&&Number.isInteger(t[0])&&t[0]>0?t[0]:0}function H(t){return!(!t||"object"!=typeof t||Array.isArray(t))}function z(t,a){return a?H(t)&&Object.prototype.hasOwnProperty.call(t,a)?t[a]:a.includes("-")&&Object.prototype.hasOwnProperty.call(t,a.split("-")[0])?t[a.split("-")[0]]:H(t)&&Object.prototype.hasOwnProperty.call(t,"all")?t.all:0:0}var Q=Object.freeze({__proto__:null,wholeExtensionRegex:U,splitByWhitespace:$,isAnEnabledValue:W,isAnEnabledRule:z,astErrMessages:q,validateString:K,fontSizeRegex:_,isoDateRegex:P,linkTypes:G,isLetter:D,isObj:H});function Z(t){return{character({chr:a,i:e}){0===a.charCodeAt(0)&&t.report({ruleId:"bad-character-null",message:"Bad character - NULL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function J(t){return{character({chr:a,i:e}){1===a.charCodeAt(0)&&t.report({ruleId:"bad-character-start-of-heading",message:"Bad character - START OF HEADING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function X(t){return{character({chr:a,i:e}){2===a.charCodeAt(0)&&t.report({ruleId:"bad-character-start-of-text",message:"Bad character - START OF TEXT.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Y(t){return{character({chr:a,i:e}){3===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-text",message:"Bad character - END OF TEXT.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1,"\n"]]}})}}}function tt(t){return{character({chr:a,i:e}){4===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-transmission",message:"Bad character - END OF TRANSMISSION.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function at(t){return{character({chr:a,i:e}){5===a.charCodeAt(0)&&t.report({ruleId:"bad-character-enquiry",message:"Bad character - ENQUIRY.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function et(t){return{character({chr:a,i:e}){6===a.charCodeAt(0)&&t.report({ruleId:"bad-character-acknowledge",message:"Bad character - ACKNOWLEDGE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function rt(t){return{character({chr:a,i:e}){7===a.charCodeAt(0)&&t.report({ruleId:"bad-character-bell",message:"Bad character - BELL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function it(t){return{character({chr:a,i:e}){8===a.charCodeAt(0)&&t.report({ruleId:"bad-character-backspace",message:"Bad character - BACKSPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}const st=(t,...a)=>{let e="never";return Array.isArray(a)&&a[0]&&"string"==typeof a[0]&&"indentationisfine"===a[0].toLowerCase()&&(e="indentationIsFine"),{character({chr:a,i:r}){if(9===a.charCodeAt(0))if("never"===e)t.report({ruleId:"bad-character-tabulation",message:"Bad character - TABULATION.",idxFrom:r,idxTo:r+1,fix:{ranges:[[r,r+1," "]]}});else if("indentationIsFine"===e){const a=b(t.str,r);null!==a&&t.str[a].trim().length&&t.report({ruleId:"bad-character-tabulation",message:"Bad character - TABULATION.",idxFrom:r,idxTo:r+1,fix:{ranges:[[r,r+1," "]]}})}}}};function nt(t){return{character({chr:a,i:e}){11===a.charCodeAt(0)&&t.report({ruleId:"bad-character-line-tabulation",message:"Bad character - LINE TABULATION.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ot(t){return{character({chr:a,i:e}){12===a.charCodeAt(0)&&t.report({ruleId:"bad-character-form-feed",message:"Bad character - FORM FEED.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function lt(t){return{character({chr:a,i:e}){14===a.charCodeAt(0)&&t.report({ruleId:"bad-character-shift-out",message:"Bad character - SHIFT OUT.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function dt(t){return{character({chr:a,i:e}){15===a.charCodeAt(0)&&t.report({ruleId:"bad-character-shift-in",message:"Bad character - SHIFT IN.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ct(t){return{character({chr:a,i:e}){16===a.charCodeAt(0)&&t.report({ruleId:"bad-character-data-link-escape",message:"Bad character - DATA LINK ESCAPE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ut(t){return{character({chr:a,i:e}){17===a.charCodeAt(0)&&t.report({ruleId:"bad-character-device-control-one",message:"Bad character - DEVICE CONTROL ONE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function bt(t){return{character({chr:a,i:e}){18===a.charCodeAt(0)&&t.report({ruleId:"bad-character-device-control-two",message:"Bad character - DEVICE CONTROL TWO.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function mt(t){return{character({chr:a,i:e}){19===a.charCodeAt(0)&&t.report({ruleId:"bad-character-device-control-three",message:"Bad character - DEVICE CONTROL THREE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ht(t){return{character({chr:a,i:e}){20===a.charCodeAt(0)&&t.report({ruleId:"bad-character-device-control-four",message:"Bad character - DEVICE CONTROL FOUR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ft(t){return{character({chr:a,i:e}){21===a.charCodeAt(0)&&t.report({ruleId:"bad-character-negative-acknowledge",message:"Bad character - NEGATIVE ACKNOWLEDGE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function gt(t){return{character({chr:a,i:e}){22===a.charCodeAt(0)&&t.report({ruleId:"bad-character-synchronous-idle",message:"Bad character - SYNCHRONOUS IDLE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function pt(t){return{character({chr:a,i:e}){23===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-transmission-block",message:"Bad character - END OF TRANSMISSION BLOCK.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function xt(t){return{character({chr:a,i:e}){24===a.charCodeAt(0)&&t.report({ruleId:"bad-character-cancel",message:"Bad character - CANCEL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function vt(t){return{character({chr:a,i:e}){25===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-medium",message:"Bad character - END OF MEDIUM.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function At(t){return{character({chr:a,i:e}){26===a.charCodeAt(0)&&t.report({ruleId:"bad-character-substitute",message:"Bad character - SUBSTITUTE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Nt(t){return{character({chr:a,i:e}){27===a.charCodeAt(0)&&t.report({ruleId:"bad-character-escape",message:"Bad character - ESCAPE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Tt(t){return{character({chr:a,i:e}){28===a.charCodeAt(0)&&t.report({ruleId:"bad-character-information-separator-four",message:"Bad character - INFORMATION SEPARATOR FOUR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Et(t){return{character({chr:a,i:e}){29===a.charCodeAt(0)&&t.report({ruleId:"bad-character-information-separator-three",message:"Bad character - INFORMATION SEPARATOR THREE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function St(t){return{character({chr:a,i:e}){30===a.charCodeAt(0)&&t.report({ruleId:"bad-character-information-separator-two",message:"Bad character - INFORMATION SEPARATOR TWO.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function It(t){return{character({chr:a,i:e}){31===a.charCodeAt(0)&&t.report({ruleId:"bad-character-information-separator-one",message:"Bad character - INFORMATION SEPARATOR ONE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Vt(t){return{character({chr:a,i:e}){127===a.charCodeAt(0)&&t.report({ruleId:"bad-character-delete",message:"Bad character - DELETE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function yt(t){return{character({chr:a,i:e}){128===a.charCodeAt(0)&&t.report({ruleId:"bad-character-control-0080",message:"Bad character - CONTROL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ft(t){return{character({chr:a,i:e}){129===a.charCodeAt(0)&&t.report({ruleId:"bad-character-control-0081",message:"Bad character - CONTROL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function wt(t){return{character({chr:a,i:e}){130===a.charCodeAt(0)&&t.report({ruleId:"bad-character-break-permitted-here",message:"Bad character - BREAK PERMITTED HERE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ct(t){return{character({chr:a,i:e}){131===a.charCodeAt(0)&&t.report({ruleId:"bad-character-no-break-here",message:"Bad character - NO BREAK HERE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Rt(t){return{character({chr:a,i:e}){132===a.charCodeAt(0)&&t.report({ruleId:"bad-character-control-0084",message:"Bad character - CONTROL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ot(t){return{character({chr:a,i:e}){133===a.charCodeAt(0)&&t.report({ruleId:"bad-character-next-line",message:"Bad character - NEXT LINE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function $t(t){return{character({chr:a,i:e}){134===a.charCodeAt(0)&&t.report({ruleId:"bad-character-start-of-selected-area",message:"Bad character - START OF SELECTED AREA.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function kt(t){return{character({chr:a,i:e}){135===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-selected-area",message:"Bad character - END OF SELECTED AREA.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Bt(t){return{character({chr:a,i:e}){136===a.charCodeAt(0)&&t.report({ruleId:"bad-character-character-tabulation-set",message:"Bad character - CHARACTER TABULATION SET.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Lt(t){return{character({chr:a,i:e}){137===a.charCodeAt(0)&&t.report({ruleId:"bad-character-character-tabulation-with-justification",message:"Bad character - CHARACTER TABULATION WITH JUSTIFICATION.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Mt(t){return{character({chr:a,i:e}){138===a.charCodeAt(0)&&t.report({ruleId:"bad-character-line-tabulation-set",message:"Bad character - LINE TABULATION SET.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function jt(t){return{character({chr:a,i:e}){139===a.charCodeAt(0)&&t.report({ruleId:"bad-character-partial-line-forward",message:"Bad character - PARTIAL LINE FORWARD.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Kt(t){return{character({chr:a,i:e}){140===a.charCodeAt(0)&&t.report({ruleId:"bad-character-partial-line-backward",message:"Bad character - PARTIAL LINE BACKWARD.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ut(t){return{character({chr:a,i:e}){141===a.charCodeAt(0)&&t.report({ruleId:"bad-character-reverse-line-feed",message:"Bad character - REVERSE LINE FEED.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Pt(t){return{character({chr:a,i:e}){142===a.charCodeAt(0)&&t.report({ruleId:"bad-character-single-shift-two",message:"Bad character - SINGLE SHIFT TWO.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function _t(t){return{character({chr:a,i:e}){143===a.charCodeAt(0)&&t.report({ruleId:"bad-character-single-shift-three",message:"Bad character - SINGLE SHIFT THREE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Gt(t){return{character({chr:a,i:e}){144===a.charCodeAt(0)&&t.report({ruleId:"bad-character-device-control-string",message:"Bad character - DEVICE CONTROL STRING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function qt(t){return{character({chr:a,i:e}){145===a.charCodeAt(0)&&t.report({ruleId:"bad-character-private-use-1",message:"Bad character - PRIVATE USE ONE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Dt(t){return{character({chr:a,i:e}){146===a.charCodeAt(0)&&t.report({ruleId:"bad-character-private-use-2",message:"Bad character - PRIVATE USE TWO.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Wt(t){return{character({chr:a,i:e}){147===a.charCodeAt(0)&&t.report({ruleId:"bad-character-set-transmit-state",message:"Bad character - SET TRANSMIT STATE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ht(t){return{character({chr:a,i:e}){148===a.charCodeAt(0)&&t.report({ruleId:"bad-character-cancel-character",message:"Bad character - CANCEL CHARACTER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function zt(t){return{character({chr:a,i:e}){149===a.charCodeAt(0)&&t.report({ruleId:"bad-character-message-waiting",message:"Bad character - MESSAGE WAITING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Qt(t){return{character({chr:a,i:e}){150===a.charCodeAt(0)&&t.report({ruleId:"bad-character-start-of-protected-area",message:"Bad character - START OF PROTECTED AREA.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Zt(t){return{character({chr:a,i:e}){151===a.charCodeAt(0)&&t.report({ruleId:"bad-character-end-of-protected-area",message:"Bad character - END OF PROTECTED AREA.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Jt(t){return{character({chr:a,i:e}){152===a.charCodeAt(0)&&t.report({ruleId:"bad-character-start-of-string",message:"Bad character - START OF STRING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Xt(t){return{character({chr:a,i:e}){153===a.charCodeAt(0)&&t.report({ruleId:"bad-character-control-0099",message:"Bad character - CONTROL.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Yt(t){return{character({chr:a,i:e}){154===a.charCodeAt(0)&&t.report({ruleId:"bad-character-single-character-introducer",message:"Bad character - SINGLE CHARACTER INTRODUCER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ta(t){return{character({chr:a,i:e}){155===a.charCodeAt(0)&&t.report({ruleId:"bad-character-control-sequence-introducer",message:"Bad character - CONTROL SEQUENCE INTRODUCER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function aa(t){return{character({chr:a,i:e}){156===a.charCodeAt(0)&&t.report({ruleId:"bad-character-string-terminator",message:"Bad character - STRING TERMINATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ea(t){return{character({chr:a,i:e}){157===a.charCodeAt(0)&&t.report({ruleId:"bad-character-operating-system-command",message:"Bad character - OPERATING SYSTEM COMMAND.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ra(t){return{character({chr:a,i:e}){158===a.charCodeAt(0)&&t.report({ruleId:"bad-character-private-message",message:"Bad character - PRIVATE MESSAGE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ia(t){return{character({chr:a,i:e}){159===a.charCodeAt(0)&&t.report({ruleId:"bad-character-application-program-command",message:"Bad character - APPLICATION PROGRAM COMMAND.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function sa(t){return{character({chr:a,i:e}){173===a.charCodeAt(0)&&t.report({ruleId:"bad-character-soft-hyphen",message:"Bad character - SOFT HYPHEN.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function na(t){return{character({chr:a,i:e}){160===a.charCodeAt(0)&&t.report({ruleId:"bad-character-non-breaking-space",message:"Bad character - NON-BREAKING SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function oa(t){return{character({chr:a,i:e}){5760===a.charCodeAt(0)&&t.report({ruleId:"bad-character-ogham-space-mark",message:"Bad character - OGHAM SPACE MARK.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function la(t){return{character({chr:a,i:e}){8192===a.charCodeAt(0)&&t.report({ruleId:"bad-character-en-quad",message:"Bad character - EN QUAD.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function da(t){return{character({chr:a,i:e}){8193===a.charCodeAt(0)&&t.report({ruleId:"bad-character-em-quad",message:"Bad character - EM QUAD.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ca(t){return{character({chr:a,i:e}){8194===a.charCodeAt(0)&&t.report({ruleId:"bad-character-en-space",message:"Bad character - EN SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ua(t){return{character({chr:a,i:e}){8195===a.charCodeAt(0)&&t.report({ruleId:"bad-character-em-space",message:"Bad character - EM SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ba(t){return{character({chr:a,i:e}){8196===a.charCodeAt(0)&&t.report({ruleId:"bad-character-three-per-em-space",message:"Bad character - THREE-PER-EM SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ma(t){return{character({chr:a,i:e}){8197===a.charCodeAt(0)&&t.report({ruleId:"bad-character-four-per-em-space",message:"Bad character - FOUR-PER-EM SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ha(t){return{character({chr:a,i:e}){8198===a.charCodeAt(0)&&t.report({ruleId:"bad-character-six-per-em-space",message:"Bad character - SIX-PER-EM SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function fa(t){return{character({chr:a,i:e}){8199===a.charCodeAt(0)&&t.report({ruleId:"bad-character-figure-space",message:"Bad character - FIGURE SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function ga(t){return{character({chr:a,i:e}){8200===a.charCodeAt(0)&&t.report({ruleId:"bad-character-punctuation-space",message:"Bad character - PUNCTUATION SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function pa(t){return{character({chr:a,i:e}){8201===a.charCodeAt(0)&&t.report({ruleId:"bad-character-thin-space",message:"Bad character - THIN SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function xa(t){return{character({chr:a,i:e}){8202===a.charCodeAt(0)&&t.report({ruleId:"bad-character-hair-space",message:"Bad character - HAIR SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function va(t){return{character({chr:a,i:e}){8203===a.charCodeAt(0)&&t.report({ruleId:"bad-character-zero-width-space",message:"Bad character - ZERO WIDTH SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function Aa(t){return{character({chr:a,i:e}){8204===a.charCodeAt(0)&&t.report({ruleId:"bad-character-zero-width-non-joiner",message:"Bad character - ZERO WIDTH NON-JOINER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Na(t){return{character({chr:a,i:e}){8205===a.charCodeAt(0)&&t.report({ruleId:"bad-character-zero-width-joiner",message:"Bad character - ZERO WIDTH JOINER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ta(t){return{character({chr:a,i:e}){8206===a.charCodeAt(0)&&t.report({ruleId:"bad-character-left-to-right-mark",message:"Bad character - LEFT-TO-RIGHT MARK.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ea(t){return{character({chr:a,i:e}){8207===a.charCodeAt(0)&&t.report({ruleId:"bad-character-right-to-left-mark",message:"Bad character - RIGHT-TO-LEFT MARK.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Sa(t){return{character({chr:a,i:e}){8234===a.charCodeAt(0)&&t.report({ruleId:"bad-character-left-to-right-embedding",message:"Bad character - LEFT-TO-RIGHT EMBEDDING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ia(t){return{character({chr:a,i:e}){8235===a.charCodeAt(0)&&t.report({ruleId:"bad-character-right-to-left-embedding",message:"Bad character - RIGHT-TO-LEFT EMBEDDING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Va(t){return{character({chr:a,i:e}){8236===a.charCodeAt(0)&&t.report({ruleId:"bad-character-pop-directional-formatting",message:"Bad character - POP DIRECTIONAL FORMATTING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ya(t){return{character({chr:a,i:e}){8237===a.charCodeAt(0)&&t.report({ruleId:"bad-character-left-to-right-override",message:"Bad character - LEFT-TO-RIGHT OVERRIDE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Fa(t){return{character({chr:a,i:e}){8238===a.charCodeAt(0)&&t.report({ruleId:"bad-character-right-to-left-override",message:"Bad character - RIGHT-TO-LEFT OVERRIDE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function wa(t){return{character({chr:a,i:e}){8288===a.charCodeAt(0)&&t.report({ruleId:"bad-character-word-joiner",message:"Bad character - WORD JOINER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ca(t){return{character({chr:a,i:e}){8289===a.charCodeAt(0)&&t.report({ruleId:"bad-character-function-application",message:"Bad character - FUNCTION APPLICATION.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ra(t){return{character({chr:a,i:e}){8290===a.charCodeAt(0)&&t.report({ruleId:"bad-character-invisible-times",message:"Bad character - INVISIBLE TIMES.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Oa(t){return{character({chr:a,i:e}){8291===a.charCodeAt(0)&&t.report({ruleId:"bad-character-invisible-separator",message:"Bad character - INVISIBLE SEPARATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function $a(t){return{character({chr:a,i:e}){8292===a.charCodeAt(0)&&t.report({ruleId:"bad-character-invisible-plus",message:"Bad character - INVISIBLE PLUS.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ka(t){return{character({chr:a,i:e}){8294===a.charCodeAt(0)&&t.report({ruleId:"bad-character-left-to-right-isolate",message:"Bad character - LEFT-TO-RIGHT ISOLATE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ba(t){return{character({chr:a,i:e}){8295===a.charCodeAt(0)&&t.report({ruleId:"bad-character-right-to-left-isolate",message:"Bad character - RIGHT-TO-LEFT ISOLATE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function La(t){return{character({chr:a,i:e}){8296===a.charCodeAt(0)&&t.report({ruleId:"bad-character-first-strong-isolate",message:"Bad character - FIRST STRONG ISOLATE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ma(t){return{character({chr:a,i:e}){8297===a.charCodeAt(0)&&t.report({ruleId:"bad-character-pop-directional-isolate",message:"Bad character - FIRST STRONG ISOLATE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function ja(t){return{character({chr:a,i:e}){8298===a.charCodeAt(0)&&t.report({ruleId:"bad-character-inhibit-symmetric-swapping",message:"Bad character - INHIBIT SYMMETRIC SWAPPING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ka(t){return{character({chr:a,i:e}){8299===a.charCodeAt(0)&&t.report({ruleId:"bad-character-activate-symmetric-swapping",message:"Bad character - INHIBIT SYMMETRIC SWAPPING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ua(t){return{character({chr:a,i:e}){8300===a.charCodeAt(0)&&t.report({ruleId:"bad-character-inhibit-arabic-form-shaping",message:"Bad character - INHIBIT ARABIC FORM SHAPING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Pa(t){return{character({chr:a,i:e}){8301===a.charCodeAt(0)&&t.report({ruleId:"bad-character-activate-arabic-form-shaping",message:"Bad character - ACTIVATE ARABIC FORM SHAPING.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function _a(t){return{character({chr:a,i:e}){8302===a.charCodeAt(0)&&t.report({ruleId:"bad-character-national-digit-shapes",message:"Bad character - NATIONAL DIGIT SHAPES.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ga(t){return{character({chr:a,i:e}){8303===a.charCodeAt(0)&&t.report({ruleId:"bad-character-nominal-digit-shapes",message:"Bad character - NOMINAL DIGIT SHAPES.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function qa(t){return{character({chr:a,i:e}){65279===a.charCodeAt(0)&&t.report({ruleId:"bad-character-zero-width-no-break-space",message:"Bad character - ZERO WIDTH NO-BREAK SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Da(t){return{character({chr:a,i:e}){65529===a.charCodeAt(0)&&t.report({ruleId:"bad-character-interlinear-annotation-anchor",message:"Bad character - INTERLINEAR ANNOTATION ANCHOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Wa(t){return{character({chr:a,i:e}){65530===a.charCodeAt(0)&&t.report({ruleId:"bad-character-interlinear-annotation-separator",message:"Bad character - INTERLINEAR ANNOTATION SEPARATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Ha(t){return{character({chr:a,i:e}){65531===a.charCodeAt(0)&&t.report({ruleId:"bad-character-interlinear-annotation-terminator",message:"Bad character - INTERLINEAR ANNOTATION TERMINATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function za(t){return{character({chr:a,i:e}){8232===a.charCodeAt(0)&&t.report({ruleId:"bad-character-line-separator",message:"Bad character - LINE SEPARATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Qa(t){return{character({chr:a,i:e}){8233===a.charCodeAt(0)&&t.report({ruleId:"bad-character-paragraph-separator",message:"Bad character - PARAGRAPH SEPARATOR.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function Za(t){return{character({chr:a,i:e}){8239===a.charCodeAt(0)&&t.report({ruleId:"bad-character-narrow-no-break-space",message:"Bad character - NARROW NO-BREAK SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function Ja(t){return{character({chr:a,i:e}){8287===a.charCodeAt(0)&&t.report({ruleId:"bad-character-medium-mathematical-space",message:"Bad character - MEDIUM MATHEMATICAL SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function Xa(t){return{character({chr:a,i:e}){12288===a.charCodeAt(0)&&t.report({ruleId:"bad-character-ideographic-space",message:"Bad character - IDEOGRAPHIC SPACE.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1," "]]}})}}}function Ya(t){return{character({chr:a,i:e}){65533===a.charCodeAt(0)&&t.report({ruleId:"bad-character-replacement-character",message:"Bad character - REPLACEMENT CHARACTER.",idxFrom:e,idxTo:e+1,fix:{ranges:[[e,e+1]]}})}}}function te(t){return{tag(a){const e=[];if("string"!=typeof t.str[a.start+1]||t.str[a.start+1].trim()||e.push([a.start+1,c(t.str,a.start+1)||t.str.length]),!t.str[a.tagNameStartsAt-1].trim()){const r=u(t.str,a.tagNameStartsAt)||0;r!==a.start&&e.push([r+1,a.tagNameStartsAt])}e.length&&t.report({ruleId:"tag-space-after-opening-bracket",message:"Bad whitespace.",idxFrom:e[0][0],idxTo:e[e.length-1][1],fix:{ranges:e}})}}}function ae(t){return{tag(a){const e=[];if(">"===t.str[a.end-1]&&!t.str[a.end-2].trim().length&&!"\\/".includes(t.str[u(t.str,a.end-1)||0])){const r=u(t.str,a.end-1)?u(t.str,a.end-1)+1:0;e.push([r,a.end-1])}e.length&&t.report({ruleId:"tag-space-before-closing-bracket",message:"Bad whitespace.",idxFrom:e[0][0],idxTo:e[e.length-1][1],fix:{ranges:e}})}}}function ee(t,a="never"){return{tag(e){t.str.slice(e.start+1,e.tagNameStartsAt);const r=u(t.str,e.end-1),i=u(t.str,r)||0;"never"===a&&e.void&&"/"===t.str[r]&&i<r-1?t.report({ruleId:"tag-space-before-closing-slash",message:"Bad whitespace.",idxFrom:i+1,idxTo:r,fix:{ranges:[[i+1,r]]}}):"always"===a&&e.void&&"/"===t.str[r]&&i===r-1&&t.report({ruleId:"tag-space-before-closing-slash",message:"Missing space.",idxFrom:r,idxTo:r,fix:{ranges:[[r,r," "]]}})}}}function re(t){return{tag(a){if(Number.isInteger(a.end)&&">"===t.str[a.end-1]&&"/"===t.str[u(t.str,a.end-1)]&&u(t.str,a.end-1)<a.end-2){const e=u(t.str,a.end-1)+1;t.report({ruleId:"tag-space-between-slash-and-bracket",message:"Bad whitespace.",idxFrom:e,idxTo:a.end-1,fix:{ranges:[[e,a.end-1]]}})}}}}function ie(t){return{tag(a){const e=[];if(Number.isInteger(a.start)&&Number.isInteger(a.tagNameStartsAt)&&t.str.slice(a.start,a.tagNameStartsAt).includes("\\"))for(let r=a.start;r<a.tagNameStartsAt;r++)"\\"===t.str[r]&&e.push([r,r+1]);if(Number.isInteger(a.end)&&">"===t.str[a.end-1]&&"\\"===t.str[u(t.str,a.end-1)]){let e=a.void?"Replace backslash with slash.":"Delete this.";const r=u(t.str,a.end-1);let i=u(t.str,r)+1,s=a.void?"/":"";t.processedRulesConfig["tag-space-before-closing-slash"]&&(Number.isInteger(t.processedRulesConfig["tag-space-before-closing-slash"])&&t.processedRulesConfig["tag-space-before-closing-slash"]>0||Array.isArray(t.processedRulesConfig["tag-space-before-closing-slash"])&&t.processedRulesConfig["tag-space-before-closing-slash"][0]>0&&"never"===t.processedRulesConfig["tag-space-before-closing-slash"][1])&&(i=u(t.str,r)+1),Array.isArray(t.processedRulesConfig["tag-space-before-closing-slash"])&&t.processedRulesConfig["tag-space-before-closing-slash"][0]>0&&"always"===t.processedRulesConfig["tag-space-before-closing-slash"][1]&&(i=u(t.str,r)+1,s=` ${s}`,a.void&&" "===t.str[i+1]?(i+=1,s=s.trim()):a.void||(s=s.trim())),a.void&&Array.isArray(t.processedRulesConfig["tag-void-slash"])&&t.processedRulesConfig["tag-void-slash"][0]>0&&"never"===t.processedRulesConfig["tag-void-slash"][1]&&(s="",i=u(t.str,r)+1,e="Delete this."),t.report({ruleId:"tag-closing-backslash",message:e,idxFrom:i,idxTo:a.end-1,fix:{ranges:[[i,a.end-1,s]]}})}e.length&&t.report({ruleId:"tag-closing-backslash",message:"Wrong slash - backslash.",idxFrom:e[0][0],idxTo:e[e.length-1][1],fix:{ranges:e}})}}}function se(t,a="always"){return{tag(e){const r=e.end-1,i=u(t.str,r),s=u(t.str,i)||0;"never"===a&&e.void&&"/"===t.str[i]?t.report({ruleId:"tag-void-slash",message:"Remove the slash.",idxFrom:s+1,idxTo:r,fix:{ranges:[[s+1,r]]}}):"always"!==a||!e.void||"/"===t.str[i]||t.processedRulesConfig["tag-closing-backslash"]&&"\\"===t.str[i]&&(Number.isInteger(t.processedRulesConfig["tag-closing-backslash"])&&t.processedRulesConfig["tag-closing-backslash"]>0||Array.isArray(t.processedRulesConfig["tag-closing-backslash"])&&t.processedRulesConfig["tag-closing-backslash"][0]>0&&"always"===t.processedRulesConfig["tag-closing-backslash"][1])||(Array.isArray(t.processedRulesConfig["tag-space-before-closing-slash"])&&"always"===t.processedRulesConfig["tag-space-before-closing-slash"][1]?t.report(" "===t.str[i+1]?{ruleId:"tag-void-slash",message:"Missing slash.",idxFrom:i+2,idxTo:r,fix:{ranges:[[i+2,r,"/"]]}}:{ruleId:"tag-void-slash",message:"Missing slash.",idxFrom:i+1,idxTo:r,fix:{ranges:[[i+1,r," /"]]}}):(void 0===t.processedRulesConfig["tag-space-before-closing-slash"]||Array.isArray(t.processedRulesConfig["tag-space-before-closing-slash"])&&"never"===t.processedRulesConfig["tag-space-before-closing-slash"][1]||Number.isInteger(t.processedRulesConfig["tag-space-before-closing-slash"])&&t.processedRulesConfig["tag-space-before-closing-slash"]>0)&&t.report({ruleId:"tag-void-slash",message:"Missing slash.",idxFrom:i+1,idxTo:r,fix:{ranges:[[i+1,r,"/"]]}}))}}}function ne(t){const a=["CDATA"],e=["doctype"];return{tag(r){if(r.tagName&&!0===r.recognised)if(a.includes(r.tagName.toUpperCase())){if(t.str.slice(r.tagNameStartsAt,r.tagNameEndsAt)!==r.tagName.toUpperCase()){const a=[[r.tagNameStartsAt,r.tagNameEndsAt,r.tagName.toUpperCase()]];t.report({ruleId:"tag-name-case",message:"Bad tag name case.",idxFrom:r.tagNameStartsAt,idxTo:r.tagNameEndsAt,fix:{ranges:a}})}}else if(t.str.slice(r.tagNameStartsAt,r.tagNameEndsAt)!==r.tagName&&!e.includes(r.tagName.toLowerCase())){t.report({ruleId:"tag-name-case",message:"Bad tag name case.",idxFrom:r.tagNameStartsAt,idxTo:r.tagNameEndsAt,fix:{ranges:[[r.tagNameStartsAt,r.tagNameEndsAt,r.tagName]]}})}}}}function oe(t,...a){return{tag(e){Array.isArray(a)&&a.length&&(o([e.tagName],a),o([e.tagName],a).length&&t.report({ruleId:"tag-is-present",message:`${e.tagName} is not allowed.`,idxFrom:e.start,idxTo:e.end,fix:{ranges:[[e.start,e.end]]}}))}}}function le(t,a="strong"){return{tag(e){"bold"===e.tagName&&t.report({ruleId:"tag-bold",message:'Tag "bold" does not exist in HTML.',idxFrom:e.start,idxTo:e.end,fix:{ranges:[[e.tagNameStartsAt,e.tagNameEndsAt,a]]}})}}}function de(t){return{tag(a){if(!a.void&&a.value.endsWith(">")&&"/"===a.value[u(a.value,a.value.length-1)]){const e=a.start+u(a.value,u(a.value,a.value.length-1))+1,r=a.start+a.value.length-1;t.report({ruleId:"tag-bad-self-closing",message:"Remove the slash.",idxFrom:e,idxTo:r,fix:{ranges:[[e,r]]}})}}}}const ce=t=>{const a=new Set(["id","class"]);function e(a){if(!Array.isArray(a)||!a.length)return a;if(!t.str[a[a.length-1][1]].trim()){const e=c(t.str,a[a.length-1][1]);"/>".includes(t.str[e])&&(a[a.length-1][1]=e)}return a}return{tag(r){if(Array.isArray(r.attribs)&&r.attribs.length>1){const i=new Set,s=new Set;for(let e=0,n=r.attribs.length;e<n;e++)i.has(r.attribs[e].attribName)?!a.has(r.attribs[e].attribName)||Array.isArray(r.attribs[e].attribValue)&&r.attribs[e].attribValue.length&&r.attribs[e].attribValue.some((t=>t.value&&(t.value.includes("'")||t.value.includes('"'))))?t.report({ruleId:"attribute-duplicate",message:`Duplicate attribute "${r.attribs[e].attribName}".`,idxFrom:r.attribs[e].attribStarts,idxTo:r.attribs[e].attribEnds,fix:null}):s.add(r.attribs[e].attribName):i.add(r.attribs[e].attribName);s&&s.size&&[...s].forEach((a=>{const i=[],s=[],n=[];for(let t=0,e=r.attribs.length;t<e;t++)r.attribs[t].attribName===a&&(i.length?n.push([t?r.attribs[t].attribLeft+1:r.attribs[t].attribStarts,r.attribs[t].attribEnds]):i.push(r.attribs[t].attribLeft+1,r.attribs[t].attribEnds),r.attribs[t].attribValueStartsAt&&$(r.attribs[t].attribValueRaw,(([a,e])=>{s.push(r.attribs[t].attribValueRaw.slice(a,e))})));const o=s.sort().join(" ");if(o&&o.length){const s=e(h([[...i,` ${a}="${o}"`],...n]));t.report({ruleId:"attribute-duplicate",message:`Duplicate attribute "${a}".`,idxFrom:r.start,idxTo:r.end,fix:{ranges:s}})}else{const s=e(h([[...i],...n]));t.report({ruleId:"attribute-duplicate",message:`Duplicate attribute "${a}".`,idxFrom:r.start,idxTo:r.end,fix:{ranges:s}})}}))}}}};function ue(t){const a=["doctype"];return{attribute(e){if(!e.attribNameRecognised&&!e.attribName.startsWith("xmlns:")&&!a.includes(e.parent.tagName)){let a=!1;for(const r of f.values())if(1===g(r,e.attribName)){t.report({ruleId:"attribute-malformed",message:`Probably meant "${r}".`,idxFrom:e.attribNameStartsAt,idxTo:e.attribNameEndsAt,fix:{ranges:[[e.attribNameStartsAt,e.attribNameEndsAt,r]]}}),a=!0;break}a||t.report({ruleId:"attribute-malformed",message:`Unrecognised attribute "${e.attribName}".`,idxFrom:e.attribNameStartsAt,idxTo:e.attribNameEndsAt,fix:null})}if(e.attribNameEndsAt&&e.attribValueStartsAt&&null!==e.attribOpeningQuoteAt&&"="!==t.str.slice(e.attribNameEndsAt,e.attribOpeningQuoteAt)){let a="Malformed around equal.";t.str.slice(e.attribNameEndsAt,e.attribOpeningQuoteAt).includes("=")||(a="Equal is missing.");let r=e.attribNameEndsAt;const i=e.attribOpeningQuoteAt;let s="=";"="===t.str[r]&&(r+=1,s=void 0),t.report({ruleId:"attribute-malformed",message:a,idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:s?[[r,i,"="]]:[[r,i]]}})}if((e.attribValueRaw.startsWith('"')||e.attribValueRaw.startsWith("'"))&&e.attribValueStartsAt&&e.attribOpeningQuoteAt&&t.str[e.attribValueStartsAt]===t.str[e.attribOpeningQuoteAt]){t.report({ruleId:"attribute-malformed",message:"Delete repeated opening quotes.",idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:[[e.attribValueStartsAt,e.attribValueStartsAt+1]]}})}if((e.attribValueRaw.endsWith('"')||e.attribValueRaw.endsWith("'"))&&e.attribValueEndsAt&&e.attribClosingQuoteAt&&t.str[e.attribValueEndsAt]===t.str[e.attribClosingQuoteAt]){t.report({ruleId:"attribute-malformed",message:"Delete repeated closing quotes.",idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:[[e.attribValueEndsAt-1,e.attribValueEndsAt]]}})}const r=[];null===e.attribOpeningQuoteAt&&null!==e.attribValueStartsAt&&r.push([e.attribValueStartsAt,e.attribValueStartsAt,null===e.attribClosingQuoteAt?'"':t.str[e.attribClosingQuoteAt]]),null===e.attribClosingQuoteAt&&null!==e.attribValueEndsAt&&r.push([e.attribValueEndsAt,e.attribValueEndsAt,null===e.attribOpeningQuoteAt?'"':t.str[e.attribOpeningQuoteAt]]),r.length&&t.report({ruleId:"attribute-malformed",message:`Quote${r.length>1?"s are":" is"} missing.`,idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:r}}),null!==e.attribOpeningQuoteAt&&null!==e.attribClosingQuoteAt&&t.str[e.attribOpeningQuoteAt]!==t.str[e.attribClosingQuoteAt]&&(e.attribValueRaw.includes('"')?e.attribValueRaw.includes("'")||t.report({ruleId:"attribute-malformed",message:("'"===t.str[e.attribClosingQuoteAt]?"Opening":"Closing")+" quote should be single.",idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:["'"===t.str[e.attribClosingQuoteAt]?[e.attribOpeningQuoteAt,e.attribOpeningQuoteAt+1,"'"]:[e.attribClosingQuoteAt,e.attribClosingQuoteAt+1,"'"]]}}):t.report({ruleId:"attribute-malformed",message:('"'===t.str[e.attribClosingQuoteAt]?"Opening":"Closing")+" quote should be double.",idxFrom:e.attribStarts,idxTo:e.attribEnds,fix:{ranges:['"'===t.str[e.attribClosingQuoteAt]?[e.attribOpeningQuoteAt,e.attribOpeningQuoteAt+1,'"']:[e.attribClosingQuoteAt,e.attribClosingQuoteAt+1,'"']]}}))}}}const be=t=>({tag(a){a.closing&&Array.isArray(a.attribs)&&a.attribs.length&&t.report({ruleId:"attribute-on-closing-tag",message:"Attribute on a closing tag.",idxFrom:a.attribs[0].attribStarts,idxTo:a.attribs[a.attribs.length-1].attribEnds,fix:null})}});function me(t){return{attribute(a){if("abbr"===a.attribName){["td","th"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-abbr",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-abbr"})}))}}}}const he=["cm","mm","in","px","pt","pc","em","ex","ch","rem","vw","vh","vmin","vmax","%"],fe=["adobe-standard-encoding","adobe-symbol-encoding","amiga-1251","ansi_x3.110-1983","asmo_449","big5","big5-hkscs","bocu-1","brf","bs_4730","bs_viewdata","cesu-8","cp50220","cp51932","csa_z243.4-1985-1","csa_z243.4-1985-2","csa_z243.4-1985-gr","csn_369103","dec-mcs","din_66003","dk-us","ds_2089","ebcdic-at-de","ebcdic-at-de-a","ebcdic-ca-fr","ebcdic-dk-no","ebcdic-dk-no-a","ebcdic-es","ebcdic-es-a","ebcdic-es-s","ebcdic-fi-se","ebcdic-fi-se-a","ebcdic-fr","ebcdic-it","ebcdic-pt","ebcdic-uk","ebcdic-us","ecma-cyrillic","es","es2","euc-kr","extended_unix_code_fixed_width_for_japanese","extended_unix_code_packed_format_for_japanese","gb18030","gb2312","gb_1988-80","gb_2312-80","gbk","gost_19768-74","greek-ccitt","greek7","greek7-old","hp-desktop","hp-legal","hp-math8","hp-pi-font","hp-roman8","hz-gb-2312","ibm-symbols","ibm-thai","ibm00858","ibm00924","ibm01140","ibm01141","ibm01142","ibm01143","ibm01144","ibm01145","ibm01146","ibm01147","ibm01148","ibm01149","ibm037","ibm038","ibm1026","ibm1047","ibm273","ibm274","ibm275","ibm277","ibm278","ibm280","ibm281","ibm284","ibm285","ibm290","ibm297","ibm420","ibm423","ibm424","ibm437","ibm500","ibm775","ibm850","ibm851","ibm852","ibm855","ibm857","ibm860","ibm861","ibm862","ibm863","ibm864","ibm865","ibm866","ibm868","ibm869","ibm870","ibm871","ibm880","ibm891","ibm903","ibm904","ibm905","ibm918","iec_p27-1","inis","inis-8","inis-cyrillic","invariant","iso-10646-j-1","iso-10646-ucs-2","iso-10646-ucs-4","iso-10646-ucs-basic","iso-10646-unicode-latin1","iso-10646-utf-1","iso-11548-1","iso-2022-cn","iso-2022-cn-ext","iso-2022-jp","iso-2022-jp-2","iso-2022-kr","iso-8859-1-windows-3.0-latin-1","iso-8859-1-windows-3.1-latin-1","iso-8859-10","iso-8859-13","iso-8859-14","iso-8859-15","iso-8859-16","iso-8859-2-windows-latin-2","iso-8859-9-windows-latin-5","iso-ir-90","iso-unicode-ibm-1261","iso-unicode-ibm-1264","iso-unicode-ibm-1265","iso-unicode-ibm-1268","iso-unicode-ibm-1276","iso_10367-box","iso_2033-1983","iso_5427","iso_5427:1981","iso_5428:1980","iso_646.basic:1983","iso_646.irv:1983","iso_6937-2-25","iso_6937-2-add","iso_8859-1:1987","iso_8859-2:1987","iso_8859-3:1988","iso_8859-4:1988","iso_8859-5:1988","iso_8859-6-e","iso_8859-6-i","iso_8859-6:1987","iso_8859-7:1987","iso_8859-8-e","iso_8859-8-i","iso_8859-8:1988","iso_8859-9:1989","iso_8859-supp","it","jis_c6220-1969-jp","jis_c6220-1969-ro","jis_c6226-1978","jis_c6226-1983","jis_c6229-1984-a","jis_c6229-1984-b","jis_c6229-1984-b-add","jis_c6229-1984-hand","jis_c6229-1984-hand-add","jis_c6229-1984-kana","jis_encoding","jis_x0201","jis_x0212-1990","jus_i.b1.002","jus_i.b1.003-mac","jus_i.b1.003-serb","koi7-switched","koi8-r","koi8-u","ks_c_5601-1987","ksc5636","kz-1048","latin-greek","latin-greek-1","latin-lap","macintosh","microsoft-publishing","mnem","mnemonic","msz_7795.3","nats-dano","nats-dano-add","nats-sefi","nats-sefi-add","nc_nc00-10:81","nf_z_62-010","nf_z_62-010_(1973)","ns_4551-1","ns_4551-2","osd_ebcdic_df03_irv","osd_ebcdic_df04_1","osd_ebcdic_df04_15","pc8-danish-norwegian","pc8-turkish","pt","pt2","ptcp154","scsu","sen_850200_b","sen_850200_c","shift_jis","t.101-g2","t.61-7bit","t.61-8bit","tis-620","tscii","unicode-1-1","unicode-1-1-utf-7","unknown-8bit","us-ascii","us-dk","utf-16","utf-16be","utf-16le","utf-32","utf-32be","utf-32le","utf-7","utf-8","ventura-international","ventura-math","ventura-us","videotex-suppl","viqr","viscii","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1255","windows-1256","windows-1257","windows-1258","windows-31j","windows-874"],ge={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},pe={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},xe=/^#([a-f0-9]{6})$/i,ve=/^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$/;function Ae(t){return{attribute(a){if("accept-charset"===a.attribName){["form"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-accept-charset",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{canBeCommaSeparated:!0,noSpaceAfterComma:!0,quickPermittedValues:["UNKNOWN"],permittedValues:fe}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-accept-charset"})}))}}}}function Ne(t){return{attribute(a){if("accept"===a.attribName){["form","input"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-accept",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["audio/*","video/*","image/*","text/html","image/png","image/gif","video/mpeg","text/css","audio/basic",U],permittedValues:Object.keys(p),canBeCommaSeparated:!0,noSpaceAfterComma:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-accept"})}))}}}}function Te(t){return{attribute(a){if("accesskey"===a.attribName){["a","area","button","input","label","legend","textarea"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-accesskey",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{charStart:e,charEnd:r,errorArr:i,trimmedVal:s}=k(a.attribValueRaw,a.attribValueStartsAt);"number"==typeof e&&"number"==typeof r&&(!(s.length>1)||s.startsWith("&")&&s.endsWith(";")||i.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:"Should be a single character (escaped or not).",fix:null})),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-accesskey"})}))}}}}function Ee(t,a,e){const r={...{from:0,to:t.length,offset:0},...a};if(" "!==t.slice(r.from,r.to)){let a;a=" "===t[r.from]?[[r.offset+r.from+1,r.offset+r.to]]:" "===t[r.to-1]?[[r.offset+r.from,r.offset+r.to-1]]:[[r.offset+r.from,r.offset+r.to," "]],e.push({idxFrom:r.offset+r.from,idxTo:r.offset+r.to,message:"Should be a single space.",fix:{ranges:a}})}}function Se(t,a,e){const r={...{offset:0,multipleOK:!1,from:0,to:t.length,attribStarts:0,attribEnds:t.length},...a},i=t.slice(r.from,r.to),s=x(i);if(Array.from(i).some((t=>!t.trim().length))){const t=[],s=[];$(i,(t=>{s.push(t)}),(a=>{t.push(a)}),a);const n=s.reduce(((t,a)=>i.slice(a[0]-r.offset,a[1]-r.offset).match(v({exact:!0}))?t+1:t),0);s.reduce(((t,a)=>t+i.slice(a[0]-r.offset,a[1]-r.offset)),""),e.push(n>1?{idxFrom:r.from+r.offset,idxTo:r.to+r.offset,message:"There should be only one URI.",fix:null}:{idxFrom:r.from+r.offset,idxTo:r.to+r.offset,message:"Remove whitespace.",fix:{ranges:t}})}else if(!i.startsWith("tel:")&&!v({exact:!0}).test(i)&&!s.res){let t="Should be an URI.",a=r.offset+r.from,s=r.offset+r.to;const n=i.match(v());Array.isArray(n)&&(t=n.length>1&&!r.multipleOK?"There should be only one URI.":"URI's should be separated with a single space.",a=r.offset+r.attribStarts,s=r.offset+r.attribEnds),e.push({idxFrom:a,idxTo:s,message:t,fix:null})}}function Ie(t,a){const e={offset:0,multipleOK:!1,separator:"space",oneSpaceAfterCommaOK:!1,leadingWhitespaceOK:!1,trailingWhitespaceOK:!1,...a},{charStart:r,charEnd:i,errorArr:s}=k(t,e.offset);return Number.isInteger(r)&&(e.multipleOK?"space"===e.separator?$(t,(([a,n])=>{const o=t.slice(a,n);o.endsWith(",")&&o.length>1?s.push({idxFrom:e.offset+n-1,idxTo:e.offset+n,message:"No commas.",fix:null}):Se(t,{...e,from:a,to:n,attribStarts:r,attribEnds:i,offset:e.offset},s)}),(([a,r])=>Ee(t,{from:a,to:r,offset:e.offset},s)),{from:r,to:i}):d(t,{offset:e.offset,oneSpaceAfterCommaOK:!1,leadingWhitespaceOK:!0,trailingWhitespaceOK:!0,cb:(a,n)=>{t.slice(a-e.offset,n-e.offset),Se(t,{...e,from:a-e.offset,to:n-e.offset,attribStarts:r,attribEnds:i,offset:e.offset},s)},errCb:(a,i)=>{let n={ranges:a};!t[a[0][0]-e.offset].trim().length&&t[a[0][0]-e.offset-1]&&r<a[0][0]-1&&("space"===e.separator||","!==t[a[0][0]-e.offset-1]&&","!==t[a[0][1]-e.offset])&&(n=null),s.push({idxFrom:a[0][0],idxTo:a[a.length-1][1],message:i,fix:n})}}):Se(t,{from:r,to:i,offset:e.offset},s)),s}function Ve(t){return{attribute(a){"action"===a.attribName&&("form"!==a.parent.tagName?t.report({ruleId:"attribute-validate-action",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}):Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-action"})})))}}}function ye(t){return{attribute(a){if("align"===a.attribName){["applet","caption","iframe","img","input","object","legend","table","hr","div","h1","h2","h3","h4","h5","h6","p","col","colgroup","tbody","td","tfoot","th","thead","tr"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-align",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});let e=[];["legend","caption"].includes(a.parent.tagName.toLowerCase())?e=K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["top","bottom","left","right"],canBeCommaSeparated:!1}):["applet","iframe","img","input","object"].includes(a.parent.tagName.toLowerCase())?e=K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["top","middle","bottom","left","right"],canBeCommaSeparated:!1}):["table","hr"].includes(a.parent.tagName.toLowerCase())?e=K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["left","center","right"],canBeCommaSeparated:!1}):["div","h1","h2","h3","h4","h5","h6","p"].includes(a.parent.tagName.toLowerCase())?e=K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["left","center","right","justify"],canBeCommaSeparated:!1}):["col","colgroup","tbody","td","tfoot","th","thead","tr"].includes(a.parent.tagName.toLowerCase())&&(e=K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["left","center","right","justify","char"],canBeCommaSeparated:!1})),e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-align"})}))}}}}const Fe={namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1};function we(t,a,e){const r={...Fe,...e},{charStart:i,charEnd:s,errorArr:n}=k(t,a);if("number"==typeof i&&"number"==typeof s){const e=n.length?t.slice(i,s):t;e.length>1&&D(e[0])&&D(e[1])&&Object.keys(pe).includes(e.toLowerCase())?r.namedCssLevel1OK?r.namedCssLevel2PlusOK||r.namedCssLevel1OK&&Object.keys(ge).includes(e.toLowerCase())||n.push({idxFrom:a+i,idxTo:a+s,message:"Named colors (CSS Level 2+) not allowed.",fix:{ranges:[[a+i,a+s,pe[e.toLowerCase()]]]}}):n.push({idxFrom:a+i,idxTo:a+s,message:"Named colors (CSS Level 1) not allowed.",fix:{ranges:[[a+i,a+s,pe[e.toLowerCase()]]]}}):e.startsWith("#")?7!==e.length?n.push({idxFrom:a+i,idxTo:a+s,message:"Hex color code should be 6 digits-long.",fix:null}):xe.test(e)?r.hexSixOK||n.push({idxFrom:a+i,idxTo:a+s,message:"Hex colors not allowed.",fix:null}):n.push({idxFrom:a+i,idxTo:a+s,message:"Unrecognised hex code.",fix:null}):e.startsWith("rgb(")?n.push({idxFrom:a+i,idxTo:a+s,message:"rgb() is not allowed.",fix:null}):n.push({idxFrom:a+i,idxTo:a+s,message:"Unrecognised color value.",fix:null})}return n}function Ce(t){return{attribute(a){if("alink"===a.attribName)if("body"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-alink",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-alink"})}))}else t.report({ruleId:"attribute-validate-alink",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Re(t){return{attribute(a){if("alt"===a.attribName&&(["applet","area","img","input"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-alt",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),null!==a.attribValueStartsAt&&null!==a.attribValueEndsAt)){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-alt"})}))}}}}function Oe(t){return{attribute(a){"archive"===a.attribName&&(["applet","object"].includes(a.parent.tagName)?a.attribValueStartsAt&&a.attribValueEndsAt?"applet"===a.parent.tagName?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,separator:"comma",multipleOK:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-archive"})})):"object"===a.parent.tagName&&Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,separator:"space",multipleOK:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-archive"})})):t.report({ruleId:`attribute-validate-${a.attribName}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null}):t.report({ruleId:"attribute-validate-archive",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function $e(t){return{attribute(a){if("axis"===a.attribName)if(["td","th"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-axis",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-axis"})}))}else t.report({ruleId:"attribute-validate-axis",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ke(t){return{attribute(a){"background"===a.attribName&&(["body","td"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-background"})})):t.report({ruleId:"attribute-validate-background",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function Be(t){return{attribute(a){if("bgcolor"===a.attribName)if(["table","tr","td","th","body"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-bgcolor",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-bgcolor"})}))}else t.report({ruleId:"attribute-validate-bgcolor",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}const Le={type:"integer",whitelistValues:[],theOnlyGoodUnits:null,plusOK:!1,negativeOK:!1,zeroOK:!0,badUnits:[],enforceCount:null,noUnitsIsFine:!0,canBeCommaSeparated:!1,customGenericValueError:null,skipWhitespaceChecks:!1,customPxMessage:null,maxValue:null};function Me({str:t,opts:a,charStart:e,charEnd:r,idxOffset:i,errorArr:s}){if("string"==typeof t)if("0"===t[e]&&(r===e+1?a.zeroOK||s.push({idxFrom:i+e,idxTo:i+r,message:"Zero not allowed.",fix:null}):"0123456789".includes(t[e+1])&&s.push({idxFrom:i+e,idxTo:i+r,message:"Number padded with zero.",fix:null})),"0123456789".includes(t[e])||"0123456789".includes(t[r-1])){if("0123456789".includes(t[e])&&"0123456789".includes(t[r-1])&&(!a.noUnitsIsFine||"integer"===a.type&&a.maxValue&&t.slice(e,r).match(/^\d+$/)&&Number.parseInt(t.slice(e,r),10)>a.maxValue))s.push(a.noUnitsIsFine?{idxFrom:i+e,idxTo:i+r,message:`Maximum, ${a.maxValue} exceeded.`,fix:null}:{idxFrom:i+e,idxTo:i+r,message:a.customGenericValueError||"Units missing.",fix:null});else for(let n=e;n<r;n++)if(!("0123456789".includes(t[n])||"."===t[n]&&"rational"===a.type||"-"===t[n]&&a.negativeOK&&0===n||"+"===t[n]&&a.plusOK&&0===n)){const e=t.slice(n,r);if(H(a)&&(Array.isArray(a.theOnlyGoodUnits)&&!a.theOnlyGoodUnits.includes(e)||Array.isArray(a.badUnits)&&a.badUnits.includes(e)))if("px"===e){s.push({idxFrom:i+n,idxTo:i+r,message:a.customPxMessage?a.customPxMessage:"Remove px.",fix:a.customPxMessage?null:{ranges:[[i+n,i+r]]}})}else{let o="Bad unit.";t.match(/-\s*-/g)?o="Repeated minus.":t.match(/\+\s*\+/g)?o="Repeated plus.":Array.isArray(a.theOnlyGoodUnits)&&a.theOnlyGoodUnits.length&&a.theOnlyGoodUnits.includes(e.trim())?o="Rogue whitespace.":a.customGenericValueError?o=a.customGenericValueError:Array.isArray(a.theOnlyGoodUnits)&&!a.theOnlyGoodUnits.length&&"integer"===a.type&&(o="Should be integer, no units."),s.push({idxFrom:i+n,idxTo:i+r,message:o,fix:null})}else if(!he.includes(e)){let t="Unrecognised unit.";/\d/.test(e)?t="Messy value.":he.includes(e.trim())&&(t="Rogue whitespace."),s.push({idxFrom:i+n,idxTo:i+r,message:t,fix:null})}break}}else{let t="Digits missing.";a.customGenericValueError?t=a.customGenericValueError:Array.isArray(a.theOnlyGoodUnits)&&!a.theOnlyGoodUnits.length&&"integer"===a.type&&(t="Should be integer, no units."),s.push({idxFrom:i+e,idxTo:i+r,message:t,fix:null})}}function je(t,a,e){if("string"!=typeof t)return[];const r={...Le,...e};let i=0,s=t.length,n=[];if(!r.skipWhitespaceChecks){const e=k(t,a);i=e.charStart,s=e.charEnd,n=e.errorArr}if(Number.isInteger(i))if(r.canBeCommaSeparated){const e=[];d(t,{offset:a,oneSpaceAfterCommaOK:!1,leadingWhitespaceOK:!0,trailingWhitespaceOK:!0,cb:(i,s)=>{const o=t.slice(i-a,s-a);Array.isArray(r.whitelistValues)&&r.whitelistValues.includes(o)||Me({str:t,opts:r,charStart:i-a,charEnd:s-a,idxOffset:a,errorArr:n}),e.push(o)},errCb:(t,a)=>{n.push({idxFrom:t[0][0],idxTo:t[t.length-1][1],message:a,fix:{ranges:t}})}}),Number.isInteger(r.enforceCount)&&e.length!==r.enforceCount?n.push({idxFrom:i+a,idxTo:s+a,message:`There should be ${r.enforceCount} values.`,fix:null}):"string"==typeof r.enforceCount&&["even","odd"].includes(r.enforceCount.toLowerCase())&&("even"===r.enforceCount.toLowerCase()&&e.length%2!=0?n.push({idxFrom:i+a,idxTo:s+a,message:`Should be an even number of values but found ${e.length}.`,fix:null}):"even"!==r.enforceCount.toLowerCase()&&e.length%2==0&&n.push({idxFrom:i+a,idxTo:s+a,message:`Should be an odd number of values but found ${e.length}.`,fix:null}))}else Array.isArray(r.whitelistValues)&&r.whitelistValues.includes(t.slice(i,s))||Me({str:t,opts:r,charStart:i,charEnd:s,idxOffset:a,errorArr:n});return n}function Ke(t){return{attribute(a){if("border"===a.attribName){["table","img","object"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-border",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",negativeOK:!1,theOnlyGoodUnits:[]}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-border"})}))}}}}function Ue(t){return{attribute(a){if("cellpadding"===a.attribName){"table"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-cellpadding",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",negativeOK:!1,theOnlyGoodUnits:["%"],badUnits:["px"],customGenericValueError:"Should be integer, either no units or percentage."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-cellpadding"})}))}}}}function Pe(t){return{attribute(a){if("cellspacing"===a.attribName){"table"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-cellspacing",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",negativeOK:!1,theOnlyGoodUnits:["%"],badUnits:["px"],customGenericValueError:"Should be integer, either no units or percentage."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-cellspacing"})}))}}}}function _e(t){return{attribute(a){if("char"===a.attribName)if(["col","colgroup","tbody","td","tfoot","th","thead","tr"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-char",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{charStart:e,charEnd:r,errorArr:i,trimmedVal:s}=k(a.attribValueRaw,a.attribValueStartsAt);"number"==typeof e&&"number"==typeof r&&(!(s.length>1)||s.startsWith("&")&&s.endsWith(";")||i.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:"Should be a single character.",fix:null})),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-char"})}))}else t.report({ruleId:"attribute-validate-char",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ge(t){return{attribute(a){if("charoff"===a.attribName)if(["col","colgroup","tbody","td","tfoot","th","thead","tr"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-charoff",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const e=je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",negativeOK:!0,theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."});a.parent.attribs.some((t=>"char"===t.attribName))||e.push({idxFrom:a.parent.start,idxTo:a.parent.end,message:'Attribute "char" missing.',fix:null}),e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-charoff"})}))}else t.report({ruleId:"attribute-validate-charoff",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function qe(t){return{attribute(a){if("charset"===a.attribName)if(["a","link","script"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-charset",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){K(a.attribValueRaw,a.attribValueStartsAt,{canBeCommaSeparated:!1,noSpaceAfterComma:!1,quickPermittedValues:[],permittedValues:fe}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-charset"})}))}else t.report({ruleId:"attribute-validate-charset",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function De(t,a,e,r){const i={xhtml:!1,enforceSiblingAttributes:null,...r};if(i.xhtml){let r='"';(null!==t.attribOpeningQuoteAt&&"'"===a.str[t.attribOpeningQuoteAt]||null!==t.attribClosingQuoteAt&&"'"===a.str[t.attribClosingQuoteAt])&&(r="'"),t.attribValueRaw===t.attribName&&a.str.slice(t.attribNameEndsAt,t.attribEnds)===`=${r}${t.attribName}${r}`||e.push({idxFrom:t.attribNameStartsAt,idxTo:t.attribNameEndsAt,message:`It's XHTML, add value, ="${t.attribName}".`,fix:{ranges:[[t.attribNameEndsAt,t.attribEnds,`=${r}${t.attribName}${r}`]]}})}else null!==t.attribValueRaw&&e.push({idxFrom:t.attribNameEndsAt,idxTo:t.attribEnds,message:"Should have no value.",fix:{ranges:[[t.attribNameEndsAt,t.attribEnds]]}});return H(i.enforceSiblingAttributes)&&Object.keys(i.enforceSiblingAttributes).length&&Object.keys(i.enforceSiblingAttributes).forEach((a=>{if(Array.isArray(t.parent.attribs)&&!t.parent.attribs.some((t=>t.attribName===a)))e.push({idxFrom:t.parent.start,idxTo:t.parent.end,message:`Should have attribute "${a}".`,fix:null});else if(i.enforceSiblingAttributes[a]&&Array.isArray(i.enforceSiblingAttributes[a])&&Array.isArray(t.parent.attribs)&&!t.parent.attribs.some((t=>t.attribName===a&&i.enforceSiblingAttributes[a].includes(t.attribValueRaw)))){let r,s;for(let e=0,i=t.parent.attribs.length;e<i;e++)if(t.parent.attribs[e].attribName===a){r=t.parent.attribs[e].attribValueStartsAt,s=t.parent.attribs[e].attribValueEndsAt;break}e.push({idxFrom:r,idxTo:s,message:`Only tags with ${i.enforceSiblingAttributes[a].map((t=>`"${t}"`)).join(" or ")} attributes can be ${t.attribName}.`,fix:null})}})),e}function We(t,a){return{attribute(e){const r=[];"checked"===e.attribName&&("input"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:{type:["checkbox","radio"]}}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-checked"})})))}}}function He(t){return{attribute(a){"cite"===a.attribName&&(["blockquote","q","del","ins"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-cite"})})):t.report({ruleId:"attribute-validate-cite",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function ze(t,a,e){const r={...{typeName:"class",from:0,to:t.length,offset:0},...a},i=new Set;$(t,(([a,s])=>{const n=t.slice(a,s);if(ve.test(n)||e.push({idxFrom:a,idxTo:s,message:`Wrong ${r.typeName} name.`,fix:null}),i.has(n)){let i=a,o=s;const l=c(t,o);o>=r.to||!l||l>r.to?i=u(t,a)+1:o=l,e.push({idxFrom:a,idxTo:s,message:`Duplicate ${r.typeName} "${n}".`,fix:{ranges:[[i,o]]}})}else i.add(n)}),(([a,i])=>Ee(t,{from:a,to:i,offset:r.offset},e)),r)}function Qe(t){return{attribute(a){if("class"===a.attribName)if(["base","basefont","head","html","meta","param","script","style","title"].includes(a.parent.tagName)&&t.report({ruleId:"attribute-validate-class",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);"number"==typeof e&&"number"==typeof r&&ze(t.str,{typeName:a.attribName,from:a.attribValueStartsAt+e,to:a.attribValueStartsAt+r,offset:0},i),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-class"})}))}else t.report({ruleId:"attribute-validate-class",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ze(t){return{attribute(a){"classid"===a.attribName&&("object"!==a.parent.tagName?t.report({ruleId:"attribute-validate-classid",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}):Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-classid"})})))}}}function Je(t){return{attribute(a){if("clear"===a.attribName){"br"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-clear",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);"number"!=typeof e||"number"!=typeof r||["left","all","right","none"].includes(t.str.slice(a.attribValueStartsAt+e,a.attribValueStartsAt+r))||i.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:"Should be: left|all|right|none.",fix:null}),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-clear"})}))}}}}function Xe(t){return{attribute(a){if("code"===a.attribName)if("applet"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-code",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-code"})}))}else t.report({ruleId:"attribute-validate-code",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ye(t){return{attribute(a){"codebase"===a.attribName&&(["applet","object"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-codebase"})})):t.report({ruleId:"attribute-validate-codebase",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function tr(t){return{attribute(a){if("codetype"===a.attribName){"object"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-codetype",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["application/javascript","application/json","application/x-www-form-urlencoded","application/xml","application/zip","application/pdf","application/sql","application/graphql","application/ld+json","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.oasis.opendocument.text","application/zstd","audio/mpeg","audio/ogg","multipart/form-data","text/css","text/html","text/xml","text/csv","text/plain","image/png","image/jpeg","image/gif","application/vnd.api+json"],permittedValues:Object.keys(p),canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-codetype"})}))}}}}function ar(t){return{attribute(a){if("color"===a.attribName)if(["basefont","font"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-color",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-color"})}))}else t.report({ruleId:"attribute-validate-color",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function er(t){return{attribute(a){if("cols"===a.attribName)if(["frameset","textarea"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-cols",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){let e=[];"frameset"===a.parent.tagName?e=je(a.attribValueRaw,a.attribValueStartsAt,{whitelistValues:["*"],theOnlyGoodUnits:["%"],badUnits:["px"],noUnitsIsFine:!0,canBeCommaSeparated:!0,type:"rational",customGenericValueError:"Should be: pixels|%|*."}):"textarea"===a.parent.tagName&&(e=je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."})),Array.isArray(e)&&e.length&&e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-cols"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function rr(t){return{attribute(a){if("colspan"===a.attribName){["th","td"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-colspan",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-colspan"})}))}}}}function ir(t,a){return{attribute(e){const r=[];"compact"===e.attribName&&(["dir","dl","menu","ol","ul"].includes(e.parent.tagName)?De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}):r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-compact"})})))}}}function sr(t){return{attribute(a){if("content"===a.attribName){"meta"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-content",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-content"})}))}}}}function nr(t){return{attribute(a){if("coords"===a.attribName)if(["area","a"].includes(a.parent.tagName))if(Array.isArray(a.parent.attribs)&&a.parent.attribs.length&&a.parent.attribs.some((t=>"shape"===t.attribName))){const e=a.parent.attribs.filter((t=>"shape"===t.attribName))[0];let r=null;"rect"===e.attribValueRaw?r=4:"circle"===e.attribValueRaw?r=3:"poly"===e.attribValueRaw&&(r="even");const i=je(a.attribValueRaw,a.attribValueStartsAt,{whitelistValues:[],theOnlyGoodUnits:[],badUnits:[],noUnitsIsFine:!0,canBeCommaSeparated:!0,enforceCount:r,type:"integer",customGenericValueError:"Should be integer, no units."});Array.isArray(i)&&i.length&&i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-coords"})}))}else t.report({ruleId:"attribute-validate-coords",idxFrom:a.parent.start,idxTo:a.parent.end,message:'Missing "shape" attribute.',fix:null});else t.report({ruleId:"attribute-validate-coords",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function or(t){return{attribute(a){"data"===a.attribName&&("object"!==a.parent.tagName?t.report({ruleId:"attribute-validate-data",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}):Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-data"})})))}}}function lr(t){return{attribute(a){if("datetime"===a.attribName){["del","ins"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-datetime",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:[P],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-datetime"})}))}}}}function dr(t,a){return{attribute(e){const r=[];"declare"===e.attribName&&("object"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-declare"})})))}}}function cr(t,a){return{attribute(e){const r=[];"defer"===e.attribName&&("script"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-defer"})})))}}}function ur(t){return{attribute(a){if("dir"===a.attribName){["applet","base","basefont","br","frame","frameset","iframe","param","script"].includes(a.parent.tagName)&&t.report({ruleId:"attribute-validate-dir",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["ltr","rtl"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-dir"})}))}}}}function br(t,a){return{attribute(e){const r=[];"disabled"===e.attribName&&(["button","input","optgroup","option","select","textarea"].includes(e.parent.tagName)?De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}):r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-disabled"})})))}}}function mr(t){return{attribute(a){if("enctype"===a.attribName){"form"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-enctype",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],permittedValues:Object.keys(p),canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-enctype"})}))}}}}function hr(t){return{attribute(a){if("face"===a.attribName){"font"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-face",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-face"})}))}}}}function fr(t){return{attribute(a){if("for"===a.attribName)if("label"!==a.parent.tagName)t.report({ruleId:"attribute-validate-for",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);if("number"==typeof e&&"number"==typeof r){const t=a.attribValueRaw.slice(e,r);let s="Wrong id name.",n=null,o=e+a.attribValueStartsAt,l=r+a.attribValueStartsAt;if(Number.isInteger(e)&&!ve.test(t)){if(Array.from(t).some((t=>!t.trim().length)))s="Should be one value, no spaces.";else if(t.includes("#")){s="Remove hash.";const t=a.attribValueRaw.indexOf("#");n={ranges:[[a.attribValueStartsAt+t,a.attribValueStartsAt+t+1]]},o=a.attribValueStartsAt+t,l=a.attribValueStartsAt+t+1}i.push({ruleId:"attribute-validate-for",idxFrom:o,idxTo:l,message:s,fix:n})}}i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-for"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function gr(t){return{attribute(a){if("frame"===a.attribName){"table"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-frame",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["void","above","below","hsides","lhs","rhs","vsides","box","border"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-frame"})}))}}}}function pr(t){return{attribute(a){if("frameborder"===a.attribName){["frame","iframe"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-frameborder",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["0","1"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-frameborder"})}))}}}}function xr(t){return{attribute(a){if("headers"===a.attribName)if(["td","th"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);ze(t.str,{typeName:"id",from:a.attribValueStartsAt+e,to:a.attribValueStartsAt+r,offset:0},i),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-headers"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-headers",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function vr(t){return{attribute(a){if("height"===a.attribName){["iframe","td","th","img","object","applet"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-height",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{badUnits:["px"],theOnlyGoodUnits:["%"],noUnitsIsFine:!0,customGenericValueError:'Should be "pixels|%".'}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-height"})}))}}}}function Ar(t){return{attribute(a){"href"===a.attribName&&(["a","area","link","base"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-href"})})):t.report({ruleId:"attribute-validate-href",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function Nr(t){return{attribute(a){if("hreflang"===a.attribName){["a","link"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-hreflang",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt),{message:s}=A(a.attribValueRaw.slice(e,r));s&&i.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:s,fix:null}),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-hreflang"})}))}}}}function Tr(t){return{attribute(a){if("hspace"===a.attribName){["applet","img","object"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-hspace",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{theOnlyGoodUnits:[],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-hspace"})}))}}}}function Er(t){return{attribute(a){if("http-equiv"===a.attribName){"meta"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-http-equiv",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["content-type","default-style","refresh","X-UA-Compatible"],canBeCommaSeparated:!1,caseInsensitive:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-http-equiv"})}))}}}}function Sr(t){return{attribute(a){if("id"===a.attribName)if(["base","head","html","meta","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-id",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);ze(t.str,{typeName:a.attribName,from:a.attribValueStartsAt+e,to:a.attribValueStartsAt+r,offset:0},i),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-id"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ir(t,a){return{attribute(e){const r=[];"ismap"===e.attribName&&(["img","input"].includes(e.parent.tagName)?De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}):r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-ismap"})})))}}}function Vr(t){return{attribute(a){if("label"===a.attribName)if(["option","optgroup"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-label",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-label"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function yr(t){return{attribute(a){if("lang"===a.attribName){["applet","base","basefont","br","frame","frameset","iframe","param","script"].includes(a.parent.tagName)&&t.report({ruleId:"attribute-validate-lang",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt),{message:s}=A(a.attribValueRaw.slice(e,r));s&&i.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:s,fix:null}),i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-lang"})}))}}}}function Fr(t){return{attribute(a){if("language"===a.attribName)if("script"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-language",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-language"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function wr(t){return{attribute(a){if("link"===a.attribName)if("body"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-link",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-link"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Cr(t){return{attribute(a){if("longdesc"===a.attribName)if(["img","frame","iframe"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-longdesc",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-longdesc"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Rr(t){return{attribute(a){if("marginheight"===a.attribName){["frame","iframe"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-marginheight",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{theOnlyGoodUnits:[],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-marginheight"})}))}}}}function Or(t){return{attribute(a){if("marginwidth"===a.attribName){["frame","iframe"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-marginwidth",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{theOnlyGoodUnits:[],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-marginwidth"})}))}}}}function $r(t){return{attribute(a){if("maxlength"===a.attribName){"input"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-maxlength",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-maxlength"})}))}}}}function kr(t){return{attribute(a){if("media"===a.attribName){["style","link"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-media",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);i.concat(N(a.attribValueRaw.slice(e,r),{offset:a.attribValueStartsAt})).forEach((a=>{t.report({...a,ruleId:"attribute-validate-media"})}))}}}}function Br(t){return{attribute(a){if("method"===a.attribName){"form"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-method",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["get","post"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-method"})}))}}}}function Lr(t,a){return{attribute(e){const r=[];"multiple"===e.attribName&&("select"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-multiple"})})))}}}function Mr(t){return{attribute(a){if("name"===a.attribName)if(["button","textarea","applet","select","form","frame","iframe","img","a","input","object","map","param","meta"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-name",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-name"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function jr(t,a){return{attribute(e){const r=[];"nohref"===e.attribName&&("area"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-nohref"})})))}}}function Kr(t,a){return{attribute(e){const r=[];"noresize"===e.attribName&&("frame"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-noresize"})})))}}}function Ur(t,a){return{attribute(e){const r=[];"noshade"===e.attribName&&("hr"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-noshade"})})))}}}function Pr(t,a){return{attribute(e){const r=[];"nowrap"===e.attribName&&(["td","th"].includes(e.parent.tagName)?De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}):r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-nowrap"})})))}}}function _r(t){return{attribute(a){if("object"===a.attribName)if("applet"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-object",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-object"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Gr(t,a){const{errorArr:e}=k(t,a);return e}function qr(t){return{attribute(a){if("onblur"===a.attribName)if(["a","area","button","input","label","select","textarea"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onblur"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onblur",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Dr(t){return{attribute(a){if("onchange"===a.attribName)if(["input","select","textarea"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onchange"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onchange",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Wr(t){return{attribute(a){if("onclick"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onclick",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onclick"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Hr(t){return{attribute(a){if("ondblclick"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-ondblclick",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-ondblclick"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function zr(t){return{attribute(a){if("onfocus"===a.attribName)if(["a","area","button","input","label","select","textarea"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onfocus"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onfocus",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Qr(t){return{attribute(a){if("onkeydown"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onkeydown",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onkeydown"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Zr(t){return{attribute(a){if("onkeypress"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onkeypress",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onkeypress"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Jr(t){return{attribute(a){if("onkeyup"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onkeyup",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onkeyup"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Xr(t){return{attribute(a){if("onload"===a.attribName)if(["frameset","body"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onload"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onload",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Yr(t){return{attribute(a){if("onmousedown"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onmousedown",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onmousedown"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ti(t){return{attribute(a){if("onmousemove"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onmousemove",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onmousemove"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ai(t){return{attribute(a){if("onmouseout"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onmouseout",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onmouseout"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ei(t){return{attribute(a){if("onmouseover"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onmouseover",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onmouseover"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ri(t){return{attribute(a){if("onmouseup"===a.attribName)if(["applet","base","basefont","bdo","br","font","frame","frameset","head","html","iframe","isindex","meta","param","script","style","title"].includes(a.parent.tagName))t.report({ruleId:"attribute-validate-onmouseup",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onmouseup"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ii(t){return{attribute(a){if("onreset"===a.attribName)if("form"!==a.parent.tagName)t.report({ruleId:"attribute-validate-onreset",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onreset"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function si(t){return{attribute(a){if("onsubmit"===a.attribName)if("form"!==a.parent.tagName)t.report({ruleId:"attribute-validate-onsubmit",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});else if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onsubmit"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ni(t){return{attribute(a){if("onselect"===a.attribName)if(["input","textarea"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onselect"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onselect",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function oi(t){return{attribute(a){if("onunload"===a.attribName)if(["frameset","body"].includes(a.parent.tagName))if(a.attribValueStartsAt&&a.attribValueEndsAt){Gr(a.attribValueRaw,a.attribValueStartsAt).forEach((a=>{t.report({...a,ruleId:"attribute-validate-onunload"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null});else t.report({ruleId:"attribute-validate-onunload",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function li(t){return{attribute(a){"profile"===a.attribName&&("head"!==a.parent.tagName?t.report({ruleId:"attribute-validate-profile",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}):Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-profile"})})))}}}function di(t){return{attribute(a){if("prompt"===a.attribName)if("isindex"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-prompt",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-prompt"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function ci(t,a){return{attribute(e){const r=[];"readonly"===e.attribName&&(["textarea","input"].includes(e.parent.tagName)?De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}):r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-readonly"})})))}}}function ui(t,a=!1){return{attribute(e){if("rel"===e.attribName){["a","link"].includes(e.parent.tagName)||t.report({ruleId:"attribute-validate-rel",idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null});K(e.attribValueRaw,e.attribValueStartsAt,{permittedValues:G,canBeCommaSeparated:!1,caseInsensitive:!a}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-rel"})}))}}}}function bi(t,a=!1){return{attribute(e){if("rev"===e.attribName){["a","link"].includes(e.parent.tagName)||t.report({ruleId:"attribute-validate-rev",idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null});K(e.attribValueRaw,e.attribValueStartsAt,{permittedValues:G,canBeCommaSeparated:!1,caseInsensitive:!a}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-rev"})}))}}}}function mi(t){return{attribute(a){if("rows"===a.attribName){["frameset","textarea"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-rows",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});let e=[];a.attribValueStartsAt&&a.attribValueEndsAt?"frameset"===a.parent.tagName?e=je(a.attribValueRaw,a.attribValueStartsAt,{whitelistValues:["*"],theOnlyGoodUnits:["%"],badUnits:["px"],noUnitsIsFine:!0,canBeCommaSeparated:!0,type:"rational",customGenericValueError:"Should be: pixels|%|*."}):"textarea"===a.parent.tagName&&(e=je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."})):t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null}),Array.isArray(e)&&e.length&&e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-rows"})}))}}}}function hi(t){return{attribute(a){if("rowspan"===a.attribName){["th","td"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-rowspan",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-rowspan"})}))}}}}function fi(t){return{attribute(a){if("rules"===a.attribName){"table"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-rules",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["none","groups","rows","cols","all"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-rules"})}))}}}}function gi(t){return{attribute(a){if("scheme"===a.attribName)if("meta"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-scheme",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-scheme"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function pi(t){return{attribute(a){if("scope"===a.attribName){["td","th"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-scope",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["row","col","rowgroup","colgroup"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-scope"})}))}}}}function xi(t){return{attribute(a){if("scrolling"===a.attribName){["frame","iframe"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-scrolling",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["auto","yes","no"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-scrolling"})}))}}}}function vi(t,a){return{attribute(e){const r=[];"selected"===e.attribName&&("option"!==e.parent.tagName?r.push({idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null}):De(e,t,r,{xhtml:!!a,enforceSiblingAttributes:null}),r.length&&r.forEach((a=>{t.report({...a,ruleId:"attribute-validate-selected"})})))}}}function Ai(t){return{attribute(a){if("shape"===a.attribName){["area","a"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-shape",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["default","rect","circle","poly"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-shape"})}))}}}}function Ni(t){return{attribute(a){if("size"===a.attribName)if(["hr","font","input","basefont","select"].includes(a.parent.tagName)){const{charStart:e,charEnd:r,errorArr:i}=k(a.attribValueRaw,a.attribValueStartsAt);if(i.forEach((a=>{t.report({...a,ruleId:"attribute-validate-size"})})),"number"==typeof e&&"number"==typeof r){const i=a.attribValueRaw.slice(e,r);if(["hr","input","select"].includes(a.parent.tagName))je(i,a.attribValueStartsAt+e,{type:"integer",negativeOK:!1,theOnlyGoodUnits:[],skipWhitespaceChecks:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-size"})}));else if(["font","basefont"].includes(a.parent.tagName)&&!i.match(_)){const s=je(i,a.attribValueStartsAt+e,{type:"integer",negativeOK:!1,theOnlyGoodUnits:[],skipWhitespaceChecks:!0,customGenericValueError:"Should be integer 1-7, plus/minus are optional."});s.length||s.push({idxFrom:a.attribValueStartsAt+e,idxTo:a.attribValueStartsAt+r,message:"Should be integer 1-7, plus/minus are optional.",fix:null}),s.forEach((a=>{t.report({...a,ruleId:"attribute-validate-size"})}))}}}else t.report({ruleId:"attribute-validate-size",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Ti(t){return{attribute(a){if("span"===a.attribName){["col","colgroup"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-span",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units.",zeroOK:!1,customPxMessage:"Columns number is not in pixels."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-span"})}))}}}}function Ei(t){return{attribute(a){"src"===a.attribName&&(["script","input","frame","iframe","img"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-src"})})):t.report({ruleId:"attribute-validate-src",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function Si(t){return{attribute(a){if("standby"===a.attribName)if("object"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-standby",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-standby"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ii(t){return{attribute(a){if("start"===a.attribName){"ol"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-start",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units.",zeroOK:!1,customPxMessage:"Starting sequence number is not in pixels."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-start"})}))}}}}const Vi={noTrailingSemi:!0};function yi(t,...a){return{attribute(e){if("style"===e.attribName){["base","basefont","head","html","meta","param","script","style","title"].includes(e.parent.tagName)&&t.report({ruleId:"attribute-validate-style",idxFrom:e.attribStarts,idxTo:e.attribEnds,message:`Tag "${e.parent.tagName}" can't have attribute "${e.attribName}".`,fix:null});(function(t,a,e){const r={...Vi,...e},{charStart:i,charEnd:s,errorArr:n}=k(t,a);if(null!==i&&s){let e=null,o=!1;for(let r=i;r<s;r++)if(":"===t[r]&&t[r+1].trim()&&n.push({idxFrom:r+1+a,idxTo:r+1+a,message:"Add a space.",fix:{ranges:[[r+1+a,r+1+a," "]]}}),t[r].trim()||null!==e||(e=r),!e||t[r].trim()||" "===t[r]||o||(o=!0),e&&r>e&&(!t[r]||t[r].trim())){if(o||r>e+1){let i=e,s=r,l=" ";" "===t[e]?(i+=1,l=null):" "===t[r-1]&&(s-=1,l=null),n.push({idxFrom:i+a,idxTo:s+a,message:(o&&r===e+1?"Replace":"Remove")+" whitespace.",fix:{ranges:[l?[i+a,s+a,l]:[i+a,s+a]]}})}e=null,o=!1}r.noTrailingSemi&&";"===t[s-1]?n.push({idxFrom:s-1+a,idxTo:s+a,message:"Delete the trailing semicolon.",fix:{ranges:[[s-1+a,s+a]]}}):r.noTrailingSemi||";"===t[s-1]||n.push({idxFrom:s+a,idxTo:s+a,message:"Add the trailing semicolon.",fix:{ranges:[[s+a,s+a,";"]]}})}return n})(e.attribValueRaw,e.attribValueStartsAt,{noTrailingSemi:Array.isArray(a)&&a.includes("noTrailingSemi")}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-style"})}))}}}}function Fi(t){return{attribute(a){if("summary"===a.attribName)if("table"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-summary",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-summary"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function wi(t){return{attribute(a){if("tabindex"===a.attribName){["a","area","button","input","object","select","textarea"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-tabindex",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units.",zeroOK:!0,customPxMessage:"Tabbing order number should not be in pixels.",maxValue:32767}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-tabindex"})}))}}}}function Ci(t){return{attribute(a){if("target"===a.attribName)if(["a","area","base","form","link"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-target",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-target"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ri(t){return{attribute(a){if("text"===a.attribName)if("body"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-text",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-text"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Oi(t){return{attribute(a){if("title"===a.attribName)if(["base","basefont","head","html","meta","param","script","title"].includes(a.parent.tagName)&&t.report({ruleId:"attribute-validate-title",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-title"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function $i(t){return{attribute(a){"type"===a.attribName&&(["a","link","object","param","script","style","input","li","ol","ul","button"].includes(a.parent.tagName)?["a","link","object","param","script","style"].includes(a.parent.tagName)?K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["application/javascript","application/json","application/x-www-form-urlencoded","application/xml","application/zip","application/pdf","application/sql","application/graphql","application/ld+json","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.oasis.opendocument.text","application/zstd","audio/mpeg","audio/ogg","multipart/form-data","text/css","text/html","text/xml","text/csv","text/plain","image/png","image/jpeg","image/gif","application/vnd.api+json"],permittedValues:Object.keys(p),canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):"input"===a.parent.tagName?K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["text","password","checkbox","radio","submit","reset","file","hidden","image","button"],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):"li"===a.parent.tagName?K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["disc","square","circle","1","a","A","i","I"],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):"ol"===a.parent.tagName?K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["1","a","A","i","I"],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):"ul"===a.parent.tagName?K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["disc","square","circle"],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):"button"===a.parent.tagName&&K(a.attribValueRaw,a.attribValueStartsAt,{quickPermittedValues:["button","submit","reset"],canBeCommaSeparated:!1,noSpaceAfterComma:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-type"})})):t.report({ruleId:"attribute-validate-type",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function ki(t){return{attribute(a){"usemap"===a.attribName&&(["img","input","object"].includes(a.parent.tagName)?Ie(a.attribValueRaw,{offset:a.attribValueStartsAt,multipleOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-usemap"})})):t.report({ruleId:"attribute-validate-usemap",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function Bi(t){return{attribute(a){"valign"===a.attribName&&(["col","colgroup","tbody","td","tfoot","th","thead","tr"].includes(a.parent.tagName)?K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["top","middle","bottom","baseline"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-valign"})})):t.report({ruleId:"attribute-validate-valign",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function Li(t){return{attribute(a){if("value"===a.attribName)if(["input","option","param","button","li"].includes(a.parent.tagName))if("li"===a.parent.tagName)je(a.attribValueRaw,a.attribValueStartsAt,{type:"integer",theOnlyGoodUnits:[],customGenericValueError:"Should be integer, no units.",zeroOK:!1,customPxMessage:"Sequence number should not be in pixels."}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-value"})}));else{const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-value"})}))}else t.report({ruleId:"attribute-validate-value",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null})}}}function Mi(t){return{attribute(a){"valuetype"===a.attribName&&("param"!==a.parent.tagName?t.report({ruleId:"attribute-validate-valuetype",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}):K(a.attribValueRaw,a.attribValueStartsAt,{permittedValues:["data","ref","object"],canBeCommaSeparated:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-valuetype"})})))}}}function ji(t){return{attribute(a){if("version"===a.attribName)if("html"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-version",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){const{errorArr:e}=k(a.attribValueRaw,a.attribValueStartsAt);e.forEach((a=>{t.report({...a,ruleId:"attribute-validate-version"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ki(t){return{attribute(a){if("vlink"===a.attribName)if("body"!==a.parent.tagName&&t.report({ruleId:"attribute-validate-vlink",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}),a.attribValueStartsAt&&a.attribValueEndsAt){we(a.attribValueRaw,a.attribValueStartsAt,{namedCssLevel1OK:!0,namedCssLevel2PlusOK:!0,hexThreeOK:!1,hexFourOK:!1,hexSixOK:!0,hexEightOK:!1}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-vlink"})}))}else t.report({ruleId:`attribute-validate-${a.attribName.toLowerCase()}`,idxFrom:a.attribStarts,idxTo:a.attribEnds,message:"Missing value.",fix:null})}}}function Ui(t){return{attribute(a){if("vspace"===a.attribName){["applet","img","object"].includes(a.parent.tagName)||t.report({ruleId:"attribute-validate-vspace",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null});je(a.attribValueRaw,a.attribValueStartsAt,{theOnlyGoodUnits:[],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-vspace"})}))}}}}function Pi(t){return{attribute(a){"width"===a.attribName&&(["hr","iframe","img","object","table","td","th","applet","col","colgroup","pre"].includes(a.parent.tagName)?"pre"===a.parent.tagName?je(a.attribValueRaw,a.attribValueStartsAt,{theOnlyGoodUnits:[],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-width"})})):["colgroup","col"].includes(a.parent.tagName)?je(a.attribValueRaw,a.attribValueStartsAt,{badUnits:["px"],theOnlyGoodUnits:["*","%"],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-width"})})):je(a.attribValueRaw,a.attribValueStartsAt,{badUnits:["px"],noUnitsIsFine:!0}).forEach((a=>{t.report({...a,ruleId:"attribute-validate-width"})})):t.report({ruleId:"attribute-validate-width",idxFrom:a.attribStarts,idxTo:a.attribEnds,message:`Tag "${a.parent.tagName}" can't have attribute "${a.attribName}".`,fix:null}))}}}function _i(t){return{entity({idxFrom:a,idxTo:e}){Object.keys(T).includes(t.str.slice(a+1,e-1))&&t.report({ruleId:"bad-named-html-entity-not-email-friendly",message:"Email-unfriendly named HTML entity.",idxFrom:a,idxTo:e,fix:{ranges:[[a,e,`&${T[t.str.slice(a+1,e-1)]};`]]}})}}}const Gi=(t,...a)=>({text(e){let r="named";Array.isArray(a)&&["named","numeric"].includes(a[0])&&(r=a[0]),function(t,a,e,r){for(let i=0,s=t.length;i<s;i++)if((t[i].charCodeAt(0)>127||'<>"&'.includes(t[i]))&&(160!==t[i].charCodeAt(0)||!Object.keys(e.processedRulesConfig).includes("bad-character-non-breaking-space")||!W(e.processedRulesConfig["bad-character-non-breaking-space"]))){let s=E.encode(t[i],{useNamedReferences:"named"===r});Object.keys(T).includes(s.slice(1,s.length-1))&&(s=`&${T[s.slice(1,s.length-1)]};`);let n="";160===t[i].charCodeAt(0)?n=" no-break space":38===t[i].charCodeAt(0)?n=" ampersand":60===t[i].charCodeAt(0)?n=" less than":62===t[i].charCodeAt(0)?n=" greater than":34===t[i].charCodeAt(0)?n=" double quotes":163===t[i].charCodeAt(0)&&(n=" pound sign"),e.report({ruleId:"character-encode",message:`Unencoded${n} character.`,idxFrom:i+a,idxTo:i+1+a,fix:{ranges:[[i+a,i+1+a,s]]}})}}(e.value,e.start,t,r)}});function qi(t,a){const e={63:"questionMark",33:"exclamationMark",59:"semicolon",187:"rightDoubleAngleQuotMark",171:"leftDoubleAngleQuotMark"};return{text(r){const i={questionMark:{whitespaceLeft:"never",whitespaceRight:"always"},exclamationMark:{whitespaceLeft:"never",whitespaceRight:"always"},semicolon:{whitespaceLeft:"never",whitespaceRight:"always"},rightDoubleAngleQuotMark:{whitespaceLeft:"never",whitespaceRight:"always"},leftDoubleAngleQuotMark:{whitespaceLeft:"never",whitespaceRight:"always"},...a};for(let a=r.start;a<r.end;a++){const s=t.str[a].charCodeAt(0);if(e[String(s)]){const n=e[String(s)];if("exclamationMark"===n&&"-"===t.str[c(t.str,a)]&&"-"===t.str[c(t.str,c(t.str,a))])return;if("never"===i[n].whitespaceLeft&&a&&!t.str[a-1].trim().length){const e=u(t.str,a)?u(t.str,a)+1:0;t.report({ruleId:"character-unspaced-punctuation",idxFrom:e,idxTo:a,message:"Remove the whitespace.",fix:{ranges:[[e,a]]}})}"never"===i[n].whitespaceRight&&a<r.end-1&&!t.str[a+1].trim().length&&t.report({ruleId:"character-unspaced-punctuation",idxFrom:a+1,idxTo:c(t.str,a)||t.str.length,message:"Remove the whitespace.",fix:{ranges:[[a+1,c(t.str,a)||t.str.length]]}}),"always"===i[n].whitespaceLeft&&a&&t.str[a-1].trim().length&&t.report({ruleId:"character-unspaced-punctuation",idxFrom:a,idxTo:a+1,message:"Add a space.",fix:{ranges:[[a,a," "]]}}),"always"===i[n].whitespaceRight&&a<r.end-1&&t.str[a+1].trim().length&&t.report({ruleId:"character-unspaced-punctuation",idxFrom:a,idxTo:a+1,message:"Add a space.",fix:{ranges:[[a+1,a+1," "]]}})}}}}}function Di(t){return{at(a){if("media"===a.identifier){N(a.query,{offset:a.queryStartsAt}).forEach((a=>{t.report({...a,ruleId:"media-malformed"})}))}}}}function Wi(t){return{comment(a){if(a.closing){(function(t){if("simple"===t.kind&&"--\x3e"===t.value||"only"===t.kind&&"<![endif]--\x3e"===t.value||"not"===t.kind&&"\x3c!--<![endif]--\x3e"===t.value)return[];const a=[];let e="";return $(t.value,(([a,r])=>{e=`${e}${t.value.slice(a,r)}`}),(([e,r])=>{a.push({ruleId:"comment-only-closing-malformed",idxFrom:t.start,idxTo:t.end,message:"Remove whitespace.",fix:{ranges:[[e+t.start,r+t.start]]}})})),"simple"===t.kind&&"--\x3e"===e||"only"===t.kind&&"<![endif]--\x3e"===e||"not"===t.kind&&"\x3c!--<![endif]--\x3e"===e||a.push({idxFrom:t.start,idxTo:t.end,message:"Malformed closing comment tag.",fix:{ranges:[[t.start,t.end,{simple:"--\x3e",only:"<![endif]--\x3e",not:"\x3c!--<![endif]--\x3e"}[t.kind]]]}}),a}(a)||[]).forEach((a=>{t.report({...a,keepSeparateWhenFixing:!0,ruleId:"comment-closing-malformed"})}))}}}}function Hi(t){return{text:a=>{S(a.value,"\x3c!--",(a=>{t.report({...a,message:"Malformed opening comment tag.",ruleId:"comment-opening-malformed",fix:{ranges:[[a.idxFrom,a.idxTo,"\x3c!--"]]}})}),{stringOffset:a.start})},comment:a=>{if(!a.closing){(function(t){const a={simple:/<!--/g,only:/<!--\[[^\]]+\]>/g,not:/<!--\[[^\]]+\]><!-->/g};if("simple"===t.kind&&a.simple.test(t.value)||"only"===t.kind&&a.only.test(t.value)||"not"===t.kind&&a.not.test(t.value))return[];const e=[];let r="";if("simple"===t.kind&&$(t.value,(([a,e])=>{r=`${r}${t.value.slice(a,e)}`}),(([a,r])=>{e.push({idxFrom:t.start,idxTo:t.end,message:"Remove whitespace.",fix:{ranges:[[a+t.start,r+t.start]]}})})),"simple"===t.kind&&a.simple.test(r)||"only"===t.kind&&a.only.test(r)||"not"===t.kind&&a.not.test(r))return e;let i=!1;if(["only","not"].includes(t.kind)&&S(t.value,"\x3c!--[",(({idxFrom:a,idxTo:r})=>{let s=r;a===t.start&&("{(".includes(t.value[r])&&I(t.value,r,"if",{trimBeforeMatching:!0})&&(i=!0,s+=1),e.push({idxFrom:t.start,idxTo:t.end,message:"Malformed opening comment tag.",fix:{ranges:[[a+t.start,s+t.start,"\x3c!--["]]}}))})),"not"===t.kind)S(t.value,"]>\x3c!--\x3e",(({idxFrom:a,idxTo:r})=>{let s=a;"})".includes(t.value[a-1])&&i&&(s-=1),e.push({idxFrom:t.start,idxTo:t.end,message:"Malformed opening comment tag.",fix:{ranges:[[s+t.start,r+t.start,"]>\x3c!--\x3e"]]}})}));else if("only"===t.kind)for(let a=t.value.length;a--;)if(t.value[a].trim().length&&!">]".includes(t.value[a])){let r=a+1;"})".includes(t.value[a])&&i&&(r-=1),"]>"!==t.value.slice(a+1)&&e.push({idxFrom:t.start,idxTo:t.end,message:"Malformed opening comment tag.",fix:{ranges:[[r+t.start,t.end,"]>"]]}});break}return e}(a)||[]).forEach((a=>{t.report({...a,ruleId:"comment-opening-malformed"})}))}}}}function zi(t){return{ast(a){e(a,((e,r,i)=>{const s=void 0!==r?r:e;if(H(s)&&"comment"===s.type&&s.closing){const e=y.get(a,V(i.path));H(e)&&"comment"===e.type&&!e.closing&&("not"===e.kind&&"only"===s.kind?t.report({ruleId:"comment-mismatching-pair",keepSeparateWhenFixing:!0,message:'Add "\x3c!--".',idxFrom:s.start,idxTo:s.end,fix:{ranges:[[s.start,s.start,"\x3c!--"]]}}):"only"===e.kind&&"not"===s.kind&&t.report({ruleId:"comment-mismatching-pair",keepSeparateWhenFixing:!0,message:'Remove "\x3c!--".',idxFrom:s.start,idxTo:s.end,fix:{ranges:[[s.start,s.end,"<![endif]--\x3e"]]}}))}return s}))}}}function Qi(t){return{ast(a){const r=[];e(a,((a,e,i)=>{const s=void 0!==e?e:a;return H(s)&&"comment"===s.type&&(r.some((t=>i.path.startsWith(t)))&&t.report({ruleId:"comment-conditional-nested",message:"Don't nest comments.",idxFrom:s.start,idxTo:s.end,fix:null}),s.closing||r.push(i.path)),s}))}}}function Zi(t){let a,e;return{tag(r){"tr"===r.tagName&&Array.isArray(r.children)&&r.children.filter((t=>"tag"===t.type&&"td"===t.tagName&&!t.closing)).length>1&&r.children.some((t=>"tag"===t.type&&"td"===t.tagName&&!t.closing&&Array.isArray(t.attribs)&&t.attribs.some((t=>"style"===t.attribName&&Array.isArray(t.attribValue)&&t.attribValue.some((t=>!("string"!=typeof t.property||!t.property.startsWith("padding-"))&&(a=t.start,e=t.end,!0)))))))&&t.report({ruleId:"email-td-sibling-padding",message:"Don't set padding on TD when sibling TD's are present.",idxFrom:a,idxTo:e,fix:null})}}}const Ji=(t,a)=>({rule(e){let r=[];if(Array.isArray(e.properties)&&e.properties.length&&e.properties.filter((t=>t.property)).length&&(r=e.properties.filter((t=>t.property))),"never"!==a&&r&&null===r[~-r.length].semi&&r[~-r.length].valueEnds){const a=r[~-r.length].valueEnds;t.report({ruleId:"css-trailing-semi",idxFrom:r[~-r.length].start,idxTo:r[~-r.length].end,message:"Add a semicolon.",fix:{ranges:[[a,a,";"]]}})}else if("never"===a&&r&&null!==r[~-r.length].semi&&r[~-r.length].valueEnds){const a=r[~-r.length].semi;t.report({ruleId:"css-trailing-semi",idxFrom:r[~-r.length].start,idxTo:r[~-r.length].end,message:"Remove the semicolon.",fix:{ranges:[[a,a+1]]}})}}}),Xi=(t,a)=>({rule(e){let r=[];if(Array.isArray(e.properties)&&e.properties.length&&e.properties.filter((t=>t.property)).length&&(r=e.properties.filter((t=>t.property))),"never"!==a&&r&&null===r[~-r.length].semi&&r[~-r.length].valueEnds){const a=r[~-r.length].valueEnds;t.report({ruleId:"css-trailing-semi",idxFrom:r[~-r.length].start,idxTo:r[~-r.length].end,message:"Add a semicolon.",fix:{ranges:[[a,a,";"]]}})}else if("never"===a&&r&&null!==r[~-r.length].semi&&r[~-r.length].valueEnds){const a=r[~-r.length].semi;t.report({ruleId:"css-trailing-semi",idxFrom:r[~-r.length].start,idxTo:r[~-r.length].end,message:"Remove the semicolon.",fix:{ranges:[[a,a+1]]}})}}}),Yi={};function ts(t){return Yi[t]}l(Yi,"bad-character-null",(()=>Z)),l(Yi,"bad-character-start-of-heading",(()=>J)),l(Yi,"bad-character-start-of-text",(()=>X)),l(Yi,"bad-character-end-of-text",(()=>Y)),l(Yi,"bad-character-end-of-transmission",(()=>tt)),l(Yi,"bad-character-enquiry",(()=>at)),l(Yi,"bad-character-acknowledge",(()=>et)),l(Yi,"bad-character-bell",(()=>rt)),l(Yi,"bad-character-backspace",(()=>it)),l(Yi,"bad-character-tabulation",(()=>st)),l(Yi,"bad-character-line-tabulation",(()=>nt)),l(Yi,"bad-character-form-feed",(()=>ot)),l(Yi,"bad-character-shift-out",(()=>lt)),l(Yi,"bad-character-shift-in",(()=>dt)),l(Yi,"bad-character-data-link-escape",(()=>ct)),l(Yi,"bad-character-device-control-one",(()=>ut)),l(Yi,"bad-character-device-control-two",(()=>bt)),l(Yi,"bad-character-device-control-three",(()=>mt)),l(Yi,"bad-character-device-control-four",(()=>ht)),l(Yi,"bad-character-negative-acknowledge",(()=>ft)),l(Yi,"bad-character-synchronous-idle",(()=>gt)),l(Yi,"bad-character-end-of-transmission-block",(()=>pt)),l(Yi,"bad-character-cancel",(()=>xt)),l(Yi,"bad-character-end-of-medium",(()=>vt)),l(Yi,"bad-character-substitute",(()=>At)),l(Yi,"bad-character-escape",(()=>Nt)),l(Yi,"bad-character-information-separator-four",(()=>Tt)),l(Yi,"bad-character-information-separator-three",(()=>Et)),l(Yi,"bad-character-information-separator-two",(()=>St)),l(Yi,"bad-character-information-separator-one",(()=>It)),l(Yi,"bad-character-delete",(()=>Vt)),l(Yi,"bad-character-control-0080",(()=>yt)),l(Yi,"bad-character-control-0081",(()=>Ft)),l(Yi,"bad-character-break-permitted-here",(()=>wt)),l(Yi,"bad-character-no-break-here",(()=>Ct)),l(Yi,"bad-character-control-0084",(()=>Rt)),l(Yi,"bad-character-next-line",(()=>Ot)),l(Yi,"bad-character-start-of-selected-area",(()=>$t)),l(Yi,"bad-character-end-of-selected-area",(()=>kt)),l(Yi,"bad-character-character-tabulation-set",(()=>Bt)),l(Yi,"bad-character-character-tabulation-with-justification",(()=>Lt)),l(Yi,"bad-character-line-tabulation-set",(()=>Mt)),l(Yi,"bad-character-partial-line-forward",(()=>jt)),l(Yi,"bad-character-partial-line-backward",(()=>Kt)),l(Yi,"bad-character-reverse-line-feed",(()=>Ut)),l(Yi,"bad-character-single-shift-two",(()=>Pt)),l(Yi,"bad-character-single-shift-three",(()=>_t)),l(Yi,"bad-character-device-control-string",(()=>Gt)),l(Yi,"bad-character-private-use-1",(()=>qt)),l(Yi,"bad-character-private-use-2",(()=>Dt)),l(Yi,"bad-character-set-transmit-state",(()=>Wt)),l(Yi,"bad-character-cancel-character",(()=>Ht)),l(Yi,"bad-character-message-waiting",(()=>zt)),l(Yi,"bad-character-start-of-protected-area",(()=>Qt)),l(Yi,"bad-character-end-of-protected-area",(()=>Zt)),l(Yi,"bad-character-start-of-string",(()=>Jt)),l(Yi,"bad-character-control-0099",(()=>Xt)),l(Yi,"bad-character-single-character-introducer",(()=>Yt)),l(Yi,"bad-character-control-sequence-introducer",(()=>ta)),l(Yi,"bad-character-string-terminator",(()=>aa)),l(Yi,"bad-character-operating-system-command",(()=>ea)),l(Yi,"bad-character-private-message",(()=>ra)),l(Yi,"bad-character-application-program-command",(()=>ia)),l(Yi,"bad-character-soft-hyphen",(()=>sa)),l(Yi,"bad-character-non-breaking-space",(()=>na)),l(Yi,"bad-character-ogham-space-mark",(()=>oa)),l(Yi,"bad-character-en-quad",(()=>la)),l(Yi,"bad-character-em-quad",(()=>da)),l(Yi,"bad-character-en-space",(()=>ca)),l(Yi,"bad-character-em-space",(()=>ua)),l(Yi,"bad-character-three-per-em-space",(()=>ba)),l(Yi,"bad-character-four-per-em-space",(()=>ma)),l(Yi,"bad-character-six-per-em-space",(()=>ha)),l(Yi,"bad-character-figure-space",(()=>fa)),l(Yi,"bad-character-punctuation-space",(()=>ga)),l(Yi,"bad-character-thin-space",(()=>pa)),l(Yi,"bad-character-hair-space",(()=>xa)),l(Yi,"bad-character-zero-width-space",(()=>va)),l(Yi,"bad-character-zero-width-non-joiner",(()=>Aa)),l(Yi,"bad-character-zero-width-joiner",(()=>Na)),l(Yi,"bad-character-left-to-right-mark",(()=>Ta)),l(Yi,"bad-character-right-to-left-mark",(()=>Ea)),l(Yi,"bad-character-left-to-right-embedding",(()=>Sa)),l(Yi,"bad-character-right-to-left-embedding",(()=>Ia)),l(Yi,"bad-character-pop-directional-formatting",(()=>Va)),l(Yi,"bad-character-left-to-right-override",(()=>ya)),l(Yi,"bad-character-right-to-left-override",(()=>Fa)),l(Yi,"bad-character-word-joiner",(()=>wa)),l(Yi,"bad-character-function-application",(()=>Ca)),l(Yi,"bad-character-invisible-times",(()=>Ra)),l(Yi,"bad-character-invisible-separator",(()=>Oa)),l(Yi,"bad-character-invisible-plus",(()=>$a)),l(Yi,"bad-character-left-to-right-isolate",(()=>ka)),l(Yi,"bad-character-right-to-left-isolate",(()=>Ba)),l(Yi,"bad-character-first-strong-isolate",(()=>La)),l(Yi,"bad-character-pop-directional-isolate",(()=>Ma)),l(Yi,"bad-character-inhibit-symmetric-swapping",(()=>ja)),l(Yi,"bad-character-activate-symmetric-swapping",(()=>Ka)),l(Yi,"bad-character-inhibit-arabic-form-shaping",(()=>Ua)),l(Yi,"bad-character-activate-arabic-form-shaping",(()=>Pa)),l(Yi,"bad-character-national-digit-shapes",(()=>_a)),l(Yi,"bad-character-nominal-digit-shapes",(()=>Ga)),l(Yi,"bad-character-zero-width-no-break-space",(()=>qa)),l(Yi,"bad-character-interlinear-annotation-anchor",(()=>Da)),l(Yi,"bad-character-interlinear-annotation-separator",(()=>Wa)),l(Yi,"bad-character-interlinear-annotation-terminator",(()=>Ha)),l(Yi,"bad-character-line-separator",(()=>za)),l(Yi,"bad-character-paragraph-separator",(()=>Qa)),l(Yi,"bad-character-narrow-no-break-space",(()=>Za)),l(Yi,"bad-character-medium-mathematical-space",(()=>Ja)),l(Yi,"bad-character-ideographic-space",(()=>Xa)),l(Yi,"bad-character-replacement-character",(()=>Ya)),l(Yi,"tag-space-after-opening-bracket",(()=>te)),l(Yi,"tag-space-before-closing-bracket",(()=>ae)),l(Yi,"tag-space-before-closing-slash",(()=>ee)),l(Yi,"tag-space-between-slash-and-bracket",(()=>re)),l(Yi,"tag-closing-backslash",(()=>ie)),l(Yi,"tag-void-slash",(()=>se)),l(Yi,"tag-name-case",(()=>ne)),l(Yi,"tag-is-present",(()=>oe)),l(Yi,"tag-bold",(()=>le)),l(Yi,"tag-bad-self-closing",(()=>de)),l(Yi,"attribute-duplicate",(()=>ce)),l(Yi,"attribute-malformed",(()=>ue)),l(Yi,"attribute-on-closing-tag",(()=>be)),l(Yi,"attribute-validate-abbr",(()=>me)),l(Yi,"attribute-validate-accept-charset",(()=>Ae)),l(Yi,"attribute-validate-accept",(()=>Ne)),l(Yi,"attribute-validate-accesskey",(()=>Te)),l(Yi,"attribute-validate-action",(()=>Ve)),l(Yi,"attribute-validate-align",(()=>ye)),l(Yi,"attribute-validate-alink",(()=>Ce)),l(Yi,"attribute-validate-alt",(()=>Re)),l(Yi,"attribute-validate-archive",(()=>Oe)),l(Yi,"attribute-validate-axis",(()=>$e)),l(Yi,"attribute-validate-background",(()=>ke)),l(Yi,"attribute-validate-bgcolor",(()=>Be)),l(Yi,"attribute-validate-border",(()=>Ke)),l(Yi,"attribute-validate-cellpadding",(()=>Ue)),l(Yi,"attribute-validate-cellspacing",(()=>Pe)),l(Yi,"attribute-validate-char",(()=>_e)),l(Yi,"attribute-validate-charoff",(()=>Ge)),l(Yi,"attribute-validate-charset",(()=>qe)),l(Yi,"attribute-validate-checked",(()=>We)),l(Yi,"attribute-validate-cite",(()=>He)),l(Yi,"attribute-validate-class",(()=>Qe)),l(Yi,"attribute-validate-classid",(()=>Ze)),l(Yi,"attribute-validate-clear",(()=>Je)),l(Yi,"attribute-validate-code",(()=>Xe)),l(Yi,"attribute-validate-codebase",(()=>Ye)),l(Yi,"attribute-validate-codetype",(()=>tr)),l(Yi,"attribute-validate-color",(()=>ar)),l(Yi,"attribute-validate-cols",(()=>er)),l(Yi,"attribute-validate-colspan",(()=>rr)),l(Yi,"attribute-validate-compact",(()=>ir)),l(Yi,"attribute-validate-content",(()=>sr)),l(Yi,"attribute-validate-coords",(()=>nr)),l(Yi,"attribute-validate-data",(()=>or)),l(Yi,"attribute-validate-datetime",(()=>lr)),l(Yi,"attribute-validate-declare",(()=>dr)),l(Yi,"attribute-validate-defer",(()=>cr)),l(Yi,"attribute-validate-dir",(()=>ur)),l(Yi,"attribute-validate-disabled",(()=>br)),l(Yi,"attribute-validate-enctype",(()=>mr)),l(Yi,"attribute-validate-face",(()=>hr)),l(Yi,"attribute-validate-for",(()=>fr)),l(Yi,"attribute-validate-frame",(()=>gr)),l(Yi,"attribute-validate-frameborder",(()=>pr)),l(Yi,"attribute-validate-headers",(()=>xr)),l(Yi,"attribute-validate-height",(()=>vr)),l(Yi,"attribute-validate-href",(()=>Ar)),l(Yi,"attribute-validate-hreflang",(()=>Nr)),l(Yi,"attribute-validate-hspace",(()=>Tr)),l(Yi,"attribute-validate-http-equiv",(()=>Er)),l(Yi,"attribute-validate-id",(()=>Sr)),l(Yi,"attribute-validate-ismap",(()=>Ir)),l(Yi,"attribute-validate-label",(()=>Vr)),l(Yi,"attribute-validate-lang",(()=>yr)),l(Yi,"attribute-validate-language",(()=>Fr)),l(Yi,"attribute-validate-link",(()=>wr)),l(Yi,"attribute-validate-longdesc",(()=>Cr)),l(Yi,"attribute-validate-marginheight",(()=>Rr)),l(Yi,"attribute-validate-marginwidth",(()=>Or)),l(Yi,"attribute-validate-maxlength",(()=>$r)),l(Yi,"attribute-validate-media",(()=>kr)),l(Yi,"attribute-validate-method",(()=>Br)),l(Yi,"attribute-validate-multiple",(()=>Lr)),l(Yi,"attribute-validate-name",(()=>Mr)),l(Yi,"attribute-validate-nohref",(()=>jr)),l(Yi,"attribute-validate-noresize",(()=>Kr)),l(Yi,"attribute-validate-noshade",(()=>Ur)),l(Yi,"attribute-validate-nowrap",(()=>Pr)),l(Yi,"attribute-validate-object",(()=>_r)),l(Yi,"attribute-validate-onblur",(()=>qr)),l(Yi,"attribute-validate-onchange",(()=>Dr)),l(Yi,"attribute-validate-onclick",(()=>Wr)),l(Yi,"attribute-validate-ondblclick",(()=>Hr)),l(Yi,"attribute-validate-onfocus",(()=>zr)),l(Yi,"attribute-validate-onkeydown",(()=>Qr)),l(Yi,"attribute-validate-onkeypress",(()=>Zr)),l(Yi,"attribute-validate-onkeyup",(()=>Jr)),l(Yi,"attribute-validate-onload",(()=>Xr)),l(Yi,"attribute-validate-onmousedown",(()=>Yr)),l(Yi,"attribute-validate-onmousemove",(()=>ti)),l(Yi,"attribute-validate-onmouseout",(()=>ai)),l(Yi,"attribute-validate-onmouseover",(()=>ei)),l(Yi,"attribute-validate-onmouseup",(()=>ri)),l(Yi,"attribute-validate-onreset",(()=>ii)),l(Yi,"attribute-validate-onsubmit",(()=>si)),l(Yi,"attribute-validate-onselect",(()=>ni)),l(Yi,"attribute-validate-onunload",(()=>oi)),l(Yi,"attribute-validate-profile",(()=>li)),l(Yi,"attribute-validate-prompt",(()=>di)),l(Yi,"attribute-validate-readonly",(()=>ci)),l(Yi,"attribute-validate-rel",(()=>ui)),l(Yi,"attribute-validate-rev",(()=>bi)),l(Yi,"attribute-validate-rows",(()=>mi)),l(Yi,"attribute-validate-rowspan",(()=>hi)),l(Yi,"attribute-validate-rules",(()=>fi)),l(Yi,"attribute-validate-scheme",(()=>gi)),l(Yi,"attribute-validate-scope",(()=>pi)),l(Yi,"attribute-validate-scrolling",(()=>xi)),l(Yi,"attribute-validate-selected",(()=>vi)),l(Yi,"attribute-validate-shape",(()=>Ai)),l(Yi,"attribute-validate-size",(()=>Ni)),l(Yi,"attribute-validate-span",(()=>Ti)),l(Yi,"attribute-validate-src",(()=>Ei)),l(Yi,"attribute-validate-standby",(()=>Si)),l(Yi,"attribute-validate-start",(()=>Ii)),l(Yi,"attribute-validate-style",(()=>yi)),l(Yi,"attribute-validate-summary",(()=>Fi)),l(Yi,"attribute-validate-tabindex",(()=>wi)),l(Yi,"attribute-validate-target",(()=>Ci)),l(Yi,"attribute-validate-text",(()=>Ri)),l(Yi,"attribute-validate-title",(()=>Oi)),l(Yi,"attribute-validate-type",(()=>$i)),l(Yi,"attribute-validate-usemap",(()=>ki)),l(Yi,"attribute-validate-valign",(()=>Bi)),l(Yi,"attribute-validate-value",(()=>Li)),l(Yi,"attribute-validate-valuetype",(()=>Mi)),l(Yi,"attribute-validate-version",(()=>ji)),l(Yi,"attribute-validate-vlink",(()=>Ki)),l(Yi,"attribute-validate-vspace",(()=>Ui)),l(Yi,"attribute-validate-width",(()=>Pi)),l(Yi,"bad-named-html-entity-not-email-friendly",(()=>_i)),l(Yi,"character-encode",(()=>Gi)),l(Yi,"character-unspaced-punctuation",(()=>qi)),l(Yi,"media-malformed",(()=>Di)),l(Yi,"comment-closing-malformed",(()=>Wi)),l(Yi,"comment-opening-malformed",(()=>Hi)),l(Yi,"comment-mismatching-pair",(()=>zi)),l(Yi,"comment-conditional-nested",(()=>Qi)),l(Yi,"email-td-sibling-padding",(()=>Zi)),l(Yi,"css-trailing-semi",(()=>Ji)),l(Yi,"css-rule-malformed",(()=>Xi)),t.defaultMaxListeners=0;class as extends t{constructor(){super(),this.messages=[],this.str="",this.strLineStartIndexes=[],this.config={},this.hasBeenCalledWithKeepSeparateWhenFixing=!1,this.processedRulesConfig={}}verify(t,i){this.messages=[],this.str=t,this.strLineStartIndexes=r(t),this.config=s(i),this.hasBeenCalledWithKeepSeparateWhenFixing=!1,this.processedRulesConfig={};const l=Object.prototype.hasOwnProperty;if(!i)return[];if("object"!=typeof i)throw new Error(`emlint/verify(): [THROW_ID_01] second input argument, config is not a plain object but ${typeof i}. It's equal to:\n${JSON.stringify(i,null,4)}`);if(!Object.keys(i).length)return[];if(!i.rules||"object"!=typeof i.rules)throw new Error(`emlint/verify(): [THROW_ID_02] config contains no rules! It was given as:\n${JSON.stringify(i,null,4)}`);const d=function(t){const a={};if(Object.keys(t).includes("all")&&W(t.all))Object.keys(Yi).forEach((e=>{a[e]=t.all}));else{let e;Object.keys(t).some((t=>!!["bad-character","bad-character*","bad-character-*"].includes(t)&&(e=t,!0)))&&F.forEach((r=>{a[r]=t[e]})),Object.keys(t).some((t=>!!["tag","tag*","tag-*"].includes(t)&&(e=t,!0)))&&w.forEach((r=>{a[r]=t[e]})),Object.keys(t).some((t=>!!["attribute","attribute*","attribute-*"].includes(t)&&(e=t,!0)))&&C.forEach((r=>{a[r]=t[e]})),Object.keys(t).some((t=>!!["css","css*","css-*"].includes(t)&&(e=t,!0)))&&R.forEach((r=>{a[r]=t[e]})),Object.keys(t).includes("bad-html-entity")&&O.forEach((e=>{a[e]=t["bad-html-entity"]})),Object.keys(t).forEach((e=>{["all","tag","tag*","tag-*","attribute","attribute*","attribute-*","bad-character","bad-character","bad-character*","bad-character-*","bad-html-entity"].includes(e)||(Object.keys(Yi).includes(e)?a[e]=s(t[e]):e.includes("*")&&Object.keys(Yi).forEach((r=>{o.isMatch(r,e)&&(a[r]=s(t[e]))})))}))}return a}(i.rules);this.processedRulesConfig=d,Object.keys(d).filter((t=>ts(t))).filter((t=>"number"==typeof d[t]?d[t]>0:!!Array.isArray(d[t])&&d[t][0]>0)).forEach((t=>{let a;a=Array.isArray(d[t])&&d[t].length>1?ts(t)(this,...d[t].slice(1)):ts(t)(this),Object.keys(a).forEach((t=>{this.on(t,((...e)=>{a[t](...e)}))}))})),this.emit("ast",e(n(t,{charCb:t=>{this.emit("character",t)},errCb:t=>{const a=z(i.rules,t.ruleId);if(a){let e="Something is wrong.";H(t)&&"string"==typeof t.ruleId&&l.call(q,t.ruleId)&&(e=q[t.ruleId]),this.report({message:e,severity:a,fix:null,...t})}}}),((t,a,e)=>{const r=void 0!==a?a:t;return!H(r)||e.parentKey&&e.parentKey.startsWith("attrib")||(this.emit(r.type,r),"tag"===r.type&&Array.isArray(r.attribs)&&r.attribs.length&&r.attribs.forEach((t=>{this.emit("attribute",{...t,parent:{...r}})}))),r}))),Object.keys(i.rules).some((t=>("all"===t||"bad-html-entity"===t||t.startsWith("bad-html-entity")||t.startsWith("bad-named-html-entity")||o.isMatch(["bad-malformed-numeric-character-entity"],t))&&(W(i.rules[t])||W(d[t]))))&&a(t,{cb:t=>{let a,e="";if(Object.keys(i.rules).includes("bad-html-entity")?"bad-named-html-entity-unrecognised"===t.ruleName?a=1:Array.isArray(i.rules["bad-html-entity"])?a=i.rules["bad-html-entity"][0]:Number.isInteger(i.rules["bad-html-entity"])&&(a=i.rules["bad-html-entity"]):Object.keys(i.rules).some((a=>!!o.isMatch(t.ruleName,a)&&(e=a,!0)))&&("bad-named-html-entity-unrecognised"===t.ruleName&&void 0===i.rules["bad-named-html-entity-unrecognised"]?a=1:Array.isArray(i.rules[e])?a=i.rules[e][0]:Number.isInteger(i.rules[e])&&(a=i.rules[e])),Number.isInteger(a)){let e;e="bad-named-html-entity-malformed-nbsp"===t.ruleName?"Malformed NBSP entity.":"bad-named-html-entity-unrecognised"===t.ruleName?"Unrecognised named entity.":"bad-named-html-entity-multiple-encoding"===t.ruleName?"HTML entity encoding over and over.":"bad-malformed-numeric-character-entity"===t.ruleName?"Malformed numeric entity.":`Malformed ${t.entityName?t.entityName:"named"} entity.`;let r=[[t.rangeFrom,t.rangeTo,t.rangeValEncoded?t.rangeValEncoded:""]];"bad-named-html-entity-unrecognised"===t.ruleName&&(r=[]),this.report({severity:a,ruleId:t.ruleName,message:e,idxFrom:t.rangeFrom,idxTo:t.rangeTo,fix:{ranges:r}})}},entityCatcherCb:(t,a)=>{this.emit("entity",{idxFrom:t,idxTo:a})}});return["tag","at","rule","text","esp","character","attribute","ast","comment","entity"].forEach((t=>{this.removeAllListeners(t)})),s(this.messages)}report(t){const{line:a,col:e}=i(this.strLineStartIndexes,t.idxFrom,!0);let r=t.severity||0;Number.isInteger(t.severity)||"number"!=typeof this.processedRulesConfig[t.ruleId]?!Number.isInteger(t.severity)&&Array.isArray(this.processedRulesConfig[t.ruleId])&&(r=this.processedRulesConfig[t.ruleId][0]):r=this.processedRulesConfig[t.ruleId],this.messages.push({fix:null,keepSeparateWhenFixing:!1,line:a,column:e,severity:r,...t,...this.hasBeenCalledWithKeepSeparateWhenFixing?{fix:null}:{}}),t.keepSeparateWhenFixing&&!this.hasBeenCalledWithKeepSeparateWhenFixing&&t.fix&&(this.hasBeenCalledWithKeepSeparateWhenFixing=!0)}}const es="4.1.2";export{as as Linter,Q as util,es as version};
