/**
 * csv-sort
 * Sorts double-entry bookkeeping CSV coming from internet banking
 * Version: 3.0.72
 * Author: Roy Revelt, Codsen Ltd
 * License: MIT
 * Homepage: https://codsen.com/os/csv-sort/
 */

!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(r="undefined"!=typeof globalThis?globalThis:r||self).csvSort=e()}(this,(function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(e)}function e(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function t(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function n(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function o(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(e){t(r,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}))}return r}function i(r){return function(r){if(Array.isArray(r))return a(r)}(r)||function(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function(r,e){if(!r)return;if("string"==typeof r)return a(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(r,e)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function s(r,e){if(!Array.isArray(r)||!r.length)return r;var t,n,i=o(o({},{strictlyTwoElementsInRangeArrays:!1,progressFn:null}),e);if(i.strictlyTwoElementsInRangeArrays&&!r.filter((function(r){return r})).every((function(r,e){return 2===r.length||(t=e,n=r.length,!1)})))throw new TypeError("ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ".concat(t,"th range (").concat(JSON.stringify(r[t],null,4),") has not two but ").concat(n," elements!"));if(!r.filter((function(r){return r})).every((function(r,e){return!(!Number.isInteger(r[0])||r[0]<0||!Number.isInteger(r[1])||r[1]<0)||(t=e,!1)})))throw new TypeError("ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ".concat(t,"th range (").concat(JSON.stringify(r[t],null,4),") does not consist of only natural numbers!"));var a=Math.pow(r.filter((function(r){return r})).length,2),s=0;return Array.from(r).filter((function(r){return r})).sort((function(r,e){return i.progressFn&&(s+=1,i.progressFn(Math.floor(100*s/a))),r[0]===e[0]?r[1]<e[1]?-1:r[1]>e[1]?1:0:r[0]<e[0]?-1:1}))}function u(e,t){function n(r){return"string"==typeof r}function a(e){return e&&"object"===r(e)&&!Array.isArray(e)}if(!Array.isArray(e)||!e.length)return null;var u,l={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};if(t){if(!a(t))throw new Error("emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:\n".concat(JSON.stringify(t,null,4)," (type ").concat(r(t),")"));if((u=o(o({},l),t)).progressFn&&a(u.progressFn)&&!Object.keys(u.progressFn).length)u.progressFn=null;else if(u.progressFn&&"function"!=typeof u.progressFn)throw new Error('ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "'.concat(r(u.progressFn),'", equal to ').concat(JSON.stringify(u.progressFn,null,4)));if(u.mergeType&&1!==u.mergeType&&2!==u.mergeType)if(n(u.mergeType)&&"1"===u.mergeType.trim())u.mergeType=1;else{if(!n(u.mergeType)||"2"!==u.mergeType.trim())throw new Error('ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "'.concat(r(u.mergeType),'", equal to ').concat(JSON.stringify(u.mergeType,null,4)));u.mergeType=2}if("boolean"!=typeof u.joinRangesThatTouchEdges)throw new Error('ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "'.concat(r(u.joinRangesThatTouchEdges),'", equal to ').concat(JSON.stringify(u.joinRangesThatTouchEdges,null,4)))}else u=o({},l);for(var c,f,p,g=e.filter((function(r){return r})).map((function(r){return i(r)})).filter((function(r){return void 0!==r[2]||r[0]!==r[1]})),h=(c=u.progressFn?s(g,{progressFn:function(r){(p=Math.floor(r/5))!==f&&(f=p,u.progressFn(p))}}):s(g)).length-1,y=h;y>0;y--)u.progressFn&&(p=Math.floor(78*(1-y/h))+21)!==f&&p>f&&(f=p,u.progressFn(p)),(c[y][0]<=c[y-1][0]||!u.joinRangesThatTouchEdges&&c[y][0]<c[y-1][1]||u.joinRangesThatTouchEdges&&c[y][0]<=c[y-1][1])&&(c[y-1][0]=Math.min(c[y][0],c[y-1][0]),c[y-1][1]=Math.max(c[y][1],c[y-1][1]),void 0!==c[y][2]&&(c[y-1][0]>=c[y][0]||c[y-1][1]<=c[y][1])&&null!==c[y-1][2]&&(null===c[y][2]&&null!==c[y-1][2]?c[y-1][2]=null:void 0!==c[y-1][2]?2===u.mergeType&&c[y-1][0]===c[y][0]?c[y-1][2]=c[y][2]:c[y-1][2]+=c[y][2]:c[y-1][2]=c[y][2]),c.splice(y,1),y=c.length);return c.length?c:null}function l(r){return null!=r}function c(r){return"string"==typeof r}var f=" ";function p(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;function t(r){return Array.from(r).reverse().join("")}function n(r,e,t){var n=t?"\n":"\r",o=t?"\r":"\n";if(!r)return r;for(var i=0,a="",s=0,u=r.length;s<u;s++)(r[s]===n||r[s]===o&&r[s-1]!==n)&&i++,"\r\n".includes(r[s])||r[s]===f?r[s]===f?a+=r[s]:r[s]===n?i<=e&&(a+=r[s],r[s+1]===o&&(a+=r[s+1],s++)):r[s]===o&&(!r[s-1]||r[s-1]!==n)&&i<=e&&(a+=r[s]):r[s+1]||i||(a+=" ");return a}if("string"==typeof r&&r.length){var o=1;"number"==typeof+e&&Number.isInteger(+e)&&+e>=0&&(o=+e);var i="",a="";if(r.trim()){if(!r[0].trim())for(var s=0,u=r.length;s<u;s++)if(r[s].trim()){i=r.slice(0,s);break}}else i=r;if(r.trim()&&(""===r.slice(-1).trim()||r.slice(-1)===f))for(var l=r.length;l--;)if(r[l].trim()){a=r.slice(l+1);break}return"".concat(n(i,o,!1)).concat(r.trim()).concat(t(n(t(a),o,!0)))}return r}function g(r){return null!=r}function h(r){return Number.isInteger(r)&&r>=0}function y(r){return"string"==typeof r}function m(r){return/^\d*$/.test(r)?parseInt(r,10):r}var d=function(){function t(e){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o(o({},{limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1}),e);if(n.mergeType&&1!==n.mergeType&&2!==n.mergeType)if(y(n.mergeType)&&"1"===n.mergeType.trim())n.mergeType=1;else{if(!y(n.mergeType)||"2"!==n.mergeType.trim())throw new Error('ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "'.concat(r(n.mergeType),'", equal to ').concat(JSON.stringify(n.mergeType,null,4)));n.mergeType=2}this.opts=n}var n,a,s;return n=t,(a=[{key:"add",value:function(e,t,n){for(var o=this,a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];if(s.length>0)throw new TypeError("ranges-push/Ranges/add(): [THROW_ID_03] Please don't overload the add() method. From the 4th input argument onwards we see these redundant arguments: ".concat(JSON.stringify(s,null,4)));if(g(e)||g(t)){if(g(e)&&!g(t)){if(Array.isArray(e)){if(e.length){if(e.some((function(r){return Array.isArray(r)})))return void e.forEach((function(r){Array.isArray(r)&&o.add.apply(o,i(r))}));e.length>1&&h(m(e[0]))&&h(m(e[1]))&&this.add.apply(this,i(e))}return}throw new TypeError('ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set ('.concat(JSON.stringify(e,null,0),') but second-one, "to" is not (').concat(JSON.stringify(t,null,0),")"))}if(!g(e)&&g(t))throw new TypeError('ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set ('.concat(JSON.stringify(t,null,0),') but first-one, "from" is not (').concat(JSON.stringify(e,null,0),")"));var l=/^\d*$/.test(e)?parseInt(e,10):e,c=/^\d*$/.test(t)?parseInt(t,10):t;if(h(n)&&(n=String(n)),!h(l)||!h(c))throw h(l)&&l>=0?new TypeError('ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it\'s of a type "'.concat(r(c),'" equal to: ').concat(JSON.stringify(c,null,4))):new TypeError('ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it\'s of a type "'.concat(r(l),'" equal to: ').concat(JSON.stringify(l,null,4)));if(g(n)&&!y(n)&&!h(n))throw new TypeError("ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ".concat(r(n),", equal to:\n").concat(JSON.stringify(n,null,4)));if(g(this.ranges)&&Array.isArray(this.last())&&l===this.last()[1]){if(this.last()[1]=c,this.last()[2],null!==this.last()[2]&&g(n)){var f=!(g(this.last()[2])&&this.last()[2].length>0)||this.opts&&this.opts.mergeType&&1!==this.opts.mergeType?n:this.last()[2]+n;this.opts.limitToBeAddedWhitespace&&(f=p(f,this.opts.limitLinebreaksCount)),y(f)&&!f.length||(this.last()[2]=f)}}else{this.ranges||(this.ranges=[]);var d=void 0===n||y(n)&&!n.length?[l,c]:[l,c,this.opts.limitToBeAddedWhitespace?p(n,this.opts.limitLinebreaksCount):n];this.ranges.push(d)}}}},{key:"push",value:function(r,e,t){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];this.add.apply(this,[r,e,t].concat(o))}},{key:"current",value:function(){var r=this;return null!=this.ranges?(this.ranges=u(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map((function(e){return g(e[2])?[e[0],e[1],p(e[2],r.opts.limitLinebreaksCount)]:e})):this.ranges):null}},{key:"wipe",value:function(){this.ranges=void 0}},{key:"replace",value:function(r){if(Array.isArray(r)&&r.length){if(!Array.isArray(r[0])||!h(r[0][0]))throw new Error("ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ".concat(JSON.stringify(r[0],null,4)," should be an array and its first element should be an integer, a string index."));this.ranges=Array.from(r)}else this.ranges=void 0}},{key:"last",value:function(){return void 0!==this.ranges&&Array.isArray(this.ranges)?this.ranges[this.ranges.length-1]:null}}])&&e(n.prototype,a),s&&e(n,s),t}();var v,b,T=Function.prototype,w=Object.prototype,S=T.toString,O=w.hasOwnProperty,N=S.call(Object),A=w.toString,I=(v=Object.getPrototypeOf,b=Object,function(r){return v(b(r))});var _=function(e){if(!function(e){return!!e&&"object"==r(e)}(e)||"[object Object]"!=A.call(e)||function(r){var e=!1;if(null!=r&&"function"!=typeof r.toString)try{e=!!(r+"")}catch(r){}return e}(e))return!1;var t=I(e);if(null===t)return!0;var n=O.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&S.call(n)==N},j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var R=function(r,e,t){return r(t={path:e,exports:{},require:function(r,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&t.path)}},t.exports),t.exports}((function(r,e){!function(t){function n(r,e){return e instanceof Object||(e={trim:!0}),"number"==typeof r&&!isNaN(r)||(r=(r||"").toString(),"trim"in e&&!e.trim?!/\s/.test(r):!!(r=r.trim())&&!isNaN(r))}r.exports&&(e=r.exports=n),e.isNumeric=n}()})),E="[object Symbol]",D=/^\s+|\s+$/g,F="\\u0300-\\u036f\\ufe20-\\ufe23",W="[\\ud800-\\udfff]",k="["+F+"\\u20d0-\\u20f0]",H="\\ud83c[\\udffb-\\udfff]",C="[^\\ud800-\\udfff]",J="(?:\\ud83c[\\udde6-\\uddff]){2}",P="[\\ud800-\\udbff][\\udc00-\\udfff]",x="(?:"+k+"|"+H+")"+"?",$="[\\ufe0e\\ufe0f]?",M=$+x+("(?:\\u200d(?:"+[C,J,P].join("|")+")"+$+x+")*"),q="(?:"+[C+k+"?",k,J,P,W].join("|")+")",K=RegExp(H+"(?="+H+")|"+q+M,"g"),U=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),V="object"==r(j)&&j&&j.Object===Object&&j,B="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,L=V||B||Function("return this")();function z(r,e,t){if(e!=e)return function(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}(r,G,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function G(r){return r!=r}function Z(r){return function(r){return U.test(r)}(r)?function(r){return r.match(K)||[]}(r):function(r){return r.split("")}(r)}var Q=Object.prototype.toString,Y=L.Symbol,X=Y?Y.prototype:void 0,rr=X?X.toString:void 0;function er(e){if("string"==typeof e)return e;if(function(e){return"symbol"==r(e)||function(e){return!!e&&"object"==r(e)}(e)&&Q.call(e)==E}(e))return rr?rr.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function tr(r,e,t){var n=r.length;return t=void 0===t?n:t,!e&&t>=n?r:function(r,e,t){var n=-1,o=r.length;e<0&&(e=-e>o?0:o+e),(t=t>o?o:t)<0&&(t+=o),o=e>t?0:t-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=r[n+e];return i}(r,e,t)}var nr=function(r,e,t){var n;if((r=null==(n=r)?"":er(n))&&(t||void 0===e))return r.replace(D,"");if(!r||!(e=er(e)))return r;var o=Z(r),i=Z(e);return tr(o,function(r,e){for(var t=-1,n=r.length;++t<n&&z(e,r[t],0)>-1;);return t}(o,i),function(r,e){for(var t=r.length;t--&&z(e,r[t],0)>-1;);return t}(o,i)+1).join("")};function or(e,t){var n,i=!0,a=[".",",","'"," "];if("string"!=typeof e)throw new TypeError("string-remove-thousand-separators/remSep(): [THROW_ID_01] Input must be string! Currently it's: ".concat(r(e),", equal to:\n").concat(JSON.stringify(e,null,4)));if(null!=t&&!_(t))throw new TypeError("string-remove-thousand-separators/remSep(): [THROW_ID_02] Options object must be a plain object! Currently it's: ".concat(r(t),", equal to:\n").concat(JSON.stringify(t,null,4)));var s=o(o({},{removeThousandSeparatorsFromNumbers:!0,padSingleDecimalPlaceNumbers:!0,forceUKStyle:!1}),t),f=nr(e.trim(),'"');if(""===f)return f;for(var p=new d,g=0,h=f.length;g<h;g++){if(s.removeThousandSeparatorsFromNumbers&&""===f[g].trim()&&p.add(g,g+1),s.removeThousandSeparatorsFromNumbers&&"'"===f[g]&&(p.add(g,g+1),"'"===f[g+1])){i=!1;break}if(a.includes(f[g])){if(void 0!==f[g+1]&&R(f[g+1]))if(void 0!==f[g+2]){if(!R(f[g+2])){i=!1;break}if(void 0!==f[g+3]){if(!R(f[g+3])){i=!1;break}if(void 0!==f[g+4]&&R(f[g+4])){i=!1;break}if(s.removeThousandSeparatorsFromNumbers&&p.add(g,g+1),n){if(f[g]!==n){i=!1;break}}else n=f[g]}else s.removeThousandSeparatorsFromNumbers&&s.forceUKStyle&&","===f[g]&&p.add(g,g+1,".")}else s.forceUKStyle&&","===f[g]&&p.add(g,g+1,"."),s.padSingleDecimalPlaceNumbers&&p.add(g+2,g+2,"0")}else if(!R(f[g])){i=!1;break}}return i&&p.current()?function(e,t,n){var o,i=0,a=0;if(0===arguments.length)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if(!c(e))throw new TypeError("ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ".concat(r(e),", equal to: ").concat(JSON.stringify(e,null,4)));if(t&&!Array.isArray(t))throw new TypeError("ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ".concat(r(t),", equal to: ").concat(JSON.stringify(t,null,4)));if(n&&"function"!=typeof n)throw new TypeError("ranges-apply: [THROW_ID_04] the third input argument must be a function (or falsey)! Currently it's: ".concat(r(n),", equal to: ").concat(JSON.stringify(n,null,4)));if(!t||!t.filter((function(r){return r})).length)return e;var s=(o=Array.isArray(t)&&(Number.isInteger(t[0])&&t[0]>=0||/^\d*$/.test(t[0]))&&(Number.isInteger(t[1])&&t[1]>=0||/^\d*$/.test(t[1]))?[Array.from(t)]:Array.from(t)).length,f=0;o.filter((function(r){return r})).forEach((function(e,t){if(n&&(i=Math.floor(f/s*10))!==a&&(a=i,n(i)),!Array.isArray(e))throw new TypeError("ranges-apply: [THROW_ID_05] ranges array, second input arg., has ".concat(t,"th element not an array: ").concat(JSON.stringify(e,null,4),", which is ").concat(r(e)));if(!Number.isInteger(e[0])||e[0]<0){if(!/^\d*$/.test(e[0]))throw new TypeError("ranges-apply: [THROW_ID_06] ranges array, second input arg. has ".concat(t,"th element, array [").concat(e[0],",").concat(e[1],"]. That array has first element not an integer, but ").concat(r(e[0]),", equal to: ").concat(JSON.stringify(e[0],null,4),". Computer doesn't like this."));o[t][0]=Number.parseInt(o[t][0],10)}if(!Number.isInteger(e[1])){if(!/^\d*$/.test(e[1]))throw new TypeError("ranges-apply: [THROW_ID_07] ranges array, second input arg. has ".concat(t,"th element, array [").concat(e[0],",").concat(e[1],"]. That array has second element not an integer, but ").concat(r(e[1]),", equal to: ").concat(JSON.stringify(e[1],null,4),". Computer doesn't like this."));o[t][1]=Number.parseInt(o[t][1],10)}f+=1}));var p=u(o,{progressFn:function(r){n&&(i=10+Math.floor(r/10))!==a&&(a=i,n(i))}});if(!p)return e;var g=p.length;if(g>0){var h=e.slice(p[g-1][1]);e=p.reduce((function(r,t,o,s){n&&(i=20+Math.floor(o/g*80))!==a&&(a=i,n(i));var u=0===o?0:s[o-1][1],c=s[o][0];return r+e.slice(u,c)+(l(s[o][2])?s[o][2]:"")}),""),e+=h}return e}(f,p.current()):f}function ir(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}function ar(r,e,t){if(e!=e)return function(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}(r,ur,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function sr(r,e,t,n){for(var o=t-1,i=r.length;++o<i;)if(n(r[o],e))return o;return-1}function ur(r){return r!=r}var lr=Array.prototype.splice,cr=Math.max;function fr(r,e,t,n){var o=n?sr:ar,i=-1,a=e.length,s=r;for(r===e&&(e=function(r,e){var t=-1,n=r.length;e||(e=Array(n));for(;++t<n;)e[t]=r[t];return e}(e)),t&&(s=function(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}(r,function(r){return function(e){return r(e)}}(t)));++i<a;)for(var u=0,l=e[i],c=t?t(l):l;(u=o(s,c,u,n))>-1;)s!==r&&lr.call(s,u,1),lr.call(r,u,1);return r}var pr=function(r,e){return e=cr(void 0===e?r.length-1:e,0),function(){for(var t=arguments,n=-1,o=cr(t.length-e,0),i=Array(o);++n<o;)i[n]=t[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=t[n];return a[e]=i,ir(r,this,a)}}((function(r,e){return r&&r.length&&e&&e.length?fr(r,e):r})),gr={symbol:"$",separator:",",decimal:".",errorOnInvalid:!1,precision:2,pattern:"!#",negativePattern:"-!#",format:function(r,e){var t=e.pattern,n=e.negativePattern,o=e.symbol,i=e.separator,a=e.decimal,s=e.groups,u=(""+r).replace(/^-/,"").split("."),l=u[0],c=u[1];return(r.value>=0?t:n).replace("!",o).replace("#",l.replace(s,"$1"+i)+(c?a+c:""))},fromCents:!1},hr=function(r){return Math.round(r)},yr=function(r){return Math.pow(10,r)},mr=/(\d)(?=(\d{3})+\b)/g,dr=/(\d)(?=(\d\d)+\d\b)/g;
/*!
   * currency.js - v2.0.3
   * http://scurker.github.io/currency.js
   *
   * Copyright (c) 2020 Jason Wilson
   * Released under MIT license
   */function vr(r,e){var t=this;if(!(t instanceof vr))return new vr(r,e);var n=Object.assign({},gr,e),o=yr(n.precision),i=br(r,n);t.intValue=i,t.value=i/o,n.increment=n.increment||1/o,n.useVedic?n.groups=dr:n.groups=mr,this.s=n,this.p=o}function br(r,e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0,o=e.decimal,i=e.errorOnInvalid,a=e.precision,s=e.fromCents,u=yr(a),l="number"==typeof r,c=r instanceof vr;if(c&&s)return r.intValue;if(l||c)n=c?r.value:r;else if("string"==typeof r){var f=new RegExp("[^-\\d"+o+"]","g"),p=new RegExp("\\"+o,"g");n=(n=r.replace(/\((.*)\)/,"-$1").replace(f,"").replace(p,"."))||0}else{if(i)throw Error("Invalid Input");n=0}return s||(n=(n*=u).toFixed(4)),t?hr(n):n}function Tr(r){return null!=r}vr.prototype={add:function(r){var e=this.intValue,t=this.s,n=this.p;return vr((e+=br(r,t))/(t.fromCents?1:n),t)},subtract:function(r){var e=this.intValue,t=this.s,n=this.p;return vr((e-=br(r,t))/(t.fromCents?1:n),t)},multiply:function(r){var e=this.intValue,t=this.s;return vr((e*=r)/(t.fromCents?1:yr(t.precision)),t)},divide:function(r){var e=this.intValue,t=this.s;return vr(e/=br(r,t,!1),t)},distribute:function(r){for(var e=this.intValue,t=this.p,n=this.s,o=[],i=Math[e>=0?"floor":"ceil"](e/r),a=Math.abs(e-i*r),s=n.fromCents?1:t;0!==r;r--){var u=vr(i/s,n);a-- >0&&(u=u[e>=0?"add":"subtract"](1/s)),o.push(u)}return o},dollars:function(){return~~this.value},cents:function(){return~~(this.intValue%this.p)},format:function(r){var e=this.s;return"function"==typeof r?r(this,e):e.format(this,Object.assign({},e,r))},toString:function(){var r,e,t=this.intValue,n=this.p,o=this.s;return(r=t/n,e=o.increment,hr(r/e)*e).toFixed(o.precision)},toJSON:function(){return this.value}};var wr=["د.إ","؋","L","֏","ƒ","Kz","$","ƒ","₼","KM","৳","лв",".د.ب","FBu","$b","R$","฿","Nu.","P","p.","BZ$","FC","CHF","¥","₡","₱","Kč","Fdj","kr","RD$","دج","kr","Nfk","Br","Ξ","€","₾","₵","GH₵","D","FG","Q","L","kn","G","Ft","Rp","₪","₹","ع.د","﷼","kr","J$","JD","¥","KSh","лв","៛","CF","₩","₩","KD","лв","₭","₨","M","Ł","Lt","Ls","LD","MAD","lei","Ar","ден","K","₮","MOP$","UM","₨","Rf","MK","RM","MT","₦","C$","kr","₨","﷼","B/.","S/.","K","₱","₨","zł","Gs","﷼","￥","lei","Дин.","₽","R₣","﷼","₨","ج.س.","kr","£","Le","S","Db","E","฿","SM","T","د.ت","T$","₤","₺","TT$","NT$","TSh","₴","USh","$U","лв","Bs","₫","VT","WS$","FCFA","Ƀ","CFA","₣","﷼","R","Z$"];function Sr(e){if("string"!=typeof e)throw new Error("csv-sort/util/findtype(): input must be string! Currently it's: ".concat(r(e)));return R(e)||wr.some((function(r){return R(e.replace(r,"").replace(/[,.]/g,""))}))?"numeric":e.trim()?"text":"empty"}return function(e){var t,n=null,i=null;if("string"==typeof e){if(0===e.length)return[[""]];t=function(e,t){var n=0,i=0,a=[],s=[],u=!1,l=!0;if(t&&"object"!==r(t))throw new Error("csv-split-easy/split(): [THROW_ID_02] Options object must be a plain object! Currently it's of a type ".concat(r(t)," equal to:\n").concat(JSON.stringify(t,null,4)));var c=o(o({},{removeThousandSeparatorsFromNumbers:!0,padSingleDecimalPlaceNumbers:!0,forceUKStyle:!1}),t);if("string"!=typeof e)throw new TypeError("csv-split-easy/split(): [THROW_ID_04] input must be string! Currently it's: ".concat(r(e),", equal to: ").concat(JSON.stringify(e,null,4)));if(""===e)return[[""]];for(var f=0,p=(e=e.trim()).length;f<p;f++){if(l&&'"'!==e[f]&&","!==e[f]&&""!==e[f].trim()&&(l=!1),'"'===e[f])if(u&&'"'===e[f+1])f+=1;else if(u){u=!1;var g=e.slice(n,f);""!==g.trim()&&(l=!1);var h=/""/.test(g)?g.replace(/""/g,'"'):or(g,{removeThousandSeparatorsFromNumbers:c.removeThousandSeparatorsFromNumbers,padSingleDecimalPlaceNumbers:c.padSingleDecimalPlaceNumbers,forceUKStyle:c.forceUKStyle});a.push(h)}else u=!0,n=f+1;else if(u||","!==e[f])if("\n"===e[f]||"\r"===e[f]){if(!i){if(i=f,!u&&'"'!==e[f-1]){var y=e.slice(n,f);""!==y.trim()&&(l=!1),a.push(or(y,{removeThousandSeparatorsFromNumbers:c.removeThousandSeparatorsFromNumbers,padSingleDecimalPlaceNumbers:c.padSingleDecimalPlaceNumbers,forceUKStyle:c.forceUKStyle}))}l?a.length=0:s.push(a),l=!0,a=[]}n=f+1}else i&&(i=0,n=f);else{if('"'!==e[f-1]&&!u){var m=e.slice(n,f);""!==m.trim()&&(l=!1),a.push(or(m,{removeThousandSeparatorsFromNumbers:c.removeThousandSeparatorsFromNumbers,padSingleDecimalPlaceNumbers:c.padSingleDecimalPlaceNumbers,forceUKStyle:c.forceUKStyle}))}n=f+1,i&&(i=0)}if(f+1===p){if('"'!==e[f]){var d=e.slice(n,f+1);d.trim()&&(l=!1),a.push(or(d,{removeThousandSeparatorsFromNumbers:c.removeThousandSeparatorsFromNumbers,padSingleDecimalPlaceNumbers:c.padSingleDecimalPlaceNumbers,forceUKStyle:c.forceUKStyle}))}l?a=[]:s.push(a),l=!0}}return 0===s.length?[[""]]:s}(e)}else{if(!Array.isArray(e))throw new TypeError("csv-sort/csvSort(): [THROW_ID_02] The input is of a wrong type! We accept either string of array of arrays. We got instead: ".concat(r(e),", equal to:\n").concat(JSON.stringify(e,null,4)));var a,s;if(!e.every((function(r,e){return Array.isArray(r)||(a=r,s=e),Array.isArray(r)})))throw new TypeError("csv-sort/csvSort(): [THROW_ID_01] the input is array as expected, but not all of its children are arrays! For example, the element at index ".concat(s," is not array but: ").concat(r(a),", equal to:\n").concat(JSON.stringify(a,null,4)))}for(var u=null,l=!1,c=!0,f=[],p=null,g=t.length-1;g>=0;g--)if(u){0===g&&(l=t[g].every((function(r){return"text"===Sr(r)||"empty"===Sr(r)}))),l||u.length===t[g].length||(c=!1);for(var h=null,y=0,m=t[g].length;y<m;y++)if(null===h&&"empty"===Sr(t[g][y].trim())&&(h=y),null!==h&&"empty"!==Sr(t[g][y].trim())&&(h=null),Sr(t[g][y].trim())!==u[y]&&!l){var d=Sr(t[g][y].trim());if(Array.isArray(u[y]))u[y].includes(d)||u[y].push(Sr(t[g][y].trim()));else if(u[y]!==d){var v=u[y];u[y]=[],u[y].push(v),u[y].push(d)}}null!==p&&null!==h&&h>p&&(!l||l&&0!==g)&&(p=h)}else if(1!==t[g].length||""!==t[g][0]){u=[];for(var b=0,T=t[g].length;b<T;b++)u.push(Sr(t[g][b].trim())),null===p&&"empty"===Sr(t[g][b].trim())&&(p=b),null!==p&&"empty"!==Sr(t[g][b].trim())&&(p=null)}p||(p=u.length);for(var w=0,S=0,O=u.length;S<O&&"empty"===u[S];S++)w=S;0!==w&&(t=t.map((function(r){return r.slice(w+1,p)})),u=u.slice(w+1,p));var N,A=[];u.forEach((function(r,e){"numeric"===r&&A.push(e)}));var I=l?1:0;if(1===A.length)N=A[0];else{if(0===A.length)throw new Error('csv-sort/csvSort(): [THROW_ID_03] Your CSV file does not contain numeric-only columns and computer was not able to detect the "Balance" column!');for(var _=Array.from(A),j=[],R=0,E=_.length;R<E;R++){for(var D=_[R],F=void 0,W=!0,k=void 0,H=!0,C=I,J=t.length;C<J&&(W&&(Tr(F)&&F===t[C][D]?(j.push(D),W=!1):F=t[C][D]),H&&(Tr(k)?t[C][D]!==k&&(H=!1):k=t[C][D]),W);C++);H&&f.push(D)}if(1===(_=pr.apply(void 0,[_].concat(j))).length)N=_[0];else if(0===_.length)throw new Error('csv-sort/csvSort(): [THROW_ID_04] The computer can\'t find the "Balance" column! It saw some numeric-only columns, but they all seem to have certain rows with the same values as rows right below/above them!')}if(!N)throw new Error("csv-sort/csvSort(): [THROW_ID_05] Sadly computer couldn't find its way in this CSV and had to stop working on it.");var P=pr.apply(void 0,[Array.from(u.reduce((function(r,e,t){return("string"==typeof e&&"numeric"===e||Array.isArray(e)&&e.includes("numeric"))&&r.push(t),r}),[])),N].concat(f)),x=[];x.push(t[t.length-1].slice(0,p));for(var $=[],M=l?1:0,q=t.length-2;q>=M;q--)for(var K=t.length-2;K>=M;K--)if(!$.includes(K)){for(var U=!1,V=0,B=P.length;V<B;V++){var L=null;""!==t[K][P[V]]&&(L=vr(t[K][P[V]]));var z=null;""!==t[K][N]&&(z=vr(t[K][N]));var G=null;""!==x[0][N]&&(G=vr(x[0][N]).format());var Z=null;""!==x[x.length-1][P[V]]&&(Z=vr(x[x.length-1][P[V]]).format());var Q=null;if(""!==x[x.length-1][N]&&(Q=vr(x[x.length-1][N])),L&&z.add(L).format()===G){x.unshift(t[K].slice(0,p)),$.push(K),U=!0;break}if(L&&z.subtract(L).format()===G){x.unshift(t[K].slice(0,p)),$.push(K),U=!0;break}if(Z&&Q.add(Z).format()===z.format()){x.push(t[K].slice(0,p)),$.push(K),U=!0;break}if(Z&&Q.subtract(Z).format()===z.format()){x.push(t[K].slice(0,p)),$.push(K),U=!0;break}}if(U){U=!1;break}}return l&&(c&&t[0].length>u.length&&(t[0].length=u.length),x.unshift(t[0].slice(0,p))),t.length-(l?2:1)!==$.length&&(n="Not all rows were recognised!",i="alert"),{res:x,msgContent:n,msgType:i}}}));
